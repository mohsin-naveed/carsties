<form [formGroup]="form" (ngSubmit)="submit()" class="grid" style="display:grid;grid-template-columns:repeat(2,1fr);gap:16px;max-width:900px">
  <mat-form-field appearance="outline"><mat-label>Title</mat-label><input matInput formControlName="title"></mat-form-field>
  <mat-form-field appearance="outline"><mat-label>Year</mat-label><input matInput type="number" formControlName="year"></mat-form-field>
  <mat-form-field appearance="outline"><mat-label>Mileage</mat-label><input matInput type="number" formControlName="mileage"></mat-form-field>
  <mat-form-field appearance="outline"><mat-label>Price</mat-label><input matInput type="number" formControlName="price"></mat-form-field>
  <mat-form-field appearance="outline"><mat-label>Color</mat-label><input matInput formControlName="color"></mat-form-field>
  <mat-form-field appearance="outline"><mat-label>Description</mat-label><textarea matInput rows="3" formControlName="description"></textarea></mat-form-field>

  <mat-form-field appearance="outline"><mat-label>Make</mat-label>
    <mat-select formControlName="makeId">
      <mat-option *ngFor="let m of makes" [value]="m.id">{{m.name}}</mat-option>
    </mat-select>
  </mat-form-field>

  <mat-form-field appearance="outline"><mat-label>Model</mat-label>
    <mat-select formControlName="modelId">
      <mat-option *ngFor="let m of models" [value]="m.id">{{m.name}}</mat-option>
    </mat-select>
  </mat-form-field>

  <mat-form-field appearance="outline"><mat-label>Generation</mat-label>
    <mat-select formControlName="generationId">
      <mat-option *ngFor="let g of generations" [value]="g.id">{{g.name}}</mat-option>
    </mat-select>
  </mat-form-field>

  <mat-form-field appearance="outline"><mat-label>Derivative</mat-label>
    <mat-select formControlName="derivativeId">
      <mat-option *ngFor="let d of derivatives" [value]="d.id">{{d.name}}</mat-option>
    </mat-select>
  </mat-form-field>

  <mat-form-field appearance="outline"><mat-label>Variant</mat-label>
    <mat-select formControlName="variantId">
      <mat-option *ngFor="let v of variants" [value]="v.id">{{v.name}}</mat-option>
    </mat-select>
  </mat-form-field>

  <mat-form-field appearance="outline"><mat-label>Transmission</mat-label>
    <mat-select formControlName="transmissionId">
      <mat-option *ngFor="let t of transmissions" [value]="t.id">{{t.name}}</mat-option>
    </mat-select>
  </mat-form-field>

  <mat-form-field appearance="outline"><mat-label>Fuel Type</mat-label>
    <mat-select formControlName="fuelTypeId">
      <mat-option *ngFor="let f of fuelTypes" [value]="f.id">{{f.name}}</mat-option>
    </mat-select>
  </mat-form-field>

  <mat-form-field appearance="outline"><mat-label>Body Type</mat-label>
    <mat-select formControlName="bodyTypeId">
      <mat-option *ngFor="let b of bodyTypes" [value]="b.id">{{b.name}}</mat-option>
    </mat-select>
  </mat-form-field>

  <div style="grid-column:1/-1;text-align:right">
    <button mat-raised-button color="primary" type="submit">Add Listing</button>
  </div>
</form>

<div style="margin-top:16px; max-width:900px; border:1px solid #ddd; padding:12px; border-radius:6px;">
  <h3 style="margin:0 0 8px 0;">Preview</h3>
  <div style="display:grid; grid-template-columns:repeat(2,1fr); gap:8px;">
    <div><strong>Make:</strong> {{ findById(makes, form.value.makeId)?.name || '-' }}</div>
    <div><strong>Model:</strong> {{ findById(models, form.value.modelId)?.name || '-' }}</div>
    <div><strong>Generation:</strong> {{ findById(generations, form.value.generationId)?.name || '-' }}</div>
    <div><strong>Derivative:</strong> {{ findById(derivatives, form.value.derivativeId)?.name || '-' }}</div>
    <div><strong>Variant:</strong> {{ findById(variants, form.value.variantId)?.name || '-' }}</div>
    <div><strong>Body Type:</strong> {{ findById(derivatives, form.value.derivativeId)?.bodyType || findById(bodyTypes, form.value.bodyTypeId)?.name || '-' }}</div>
    <div><strong>Transmission:</strong> {{ findById(derivatives, form.value.derivativeId)?.transmission || findById(transmissions, form.value.transmissionId)?.name || '-' }}</div>
    <div><strong>Fuel:</strong> {{ findById(derivatives, form.value.derivativeId)?.fuelType || findById(fuelTypes, form.value.fuelTypeId)?.name || '-' }}</div>
    <div><strong>Seats:</strong> {{ findById(derivatives, form.value.derivativeId)?.seats || '-' }}</div>
    <div><strong>Doors:</strong> {{ findById(derivatives, form.value.derivativeId)?.doors || '-' }}</div>
    <div><strong>Engine:</strong> {{ findById(derivatives, form.value.derivativeId)?.engine || '-' }}</div>
    <div><strong>Battery (kWh):</strong> {{ findById(derivatives, form.value.derivativeId)?.batteryCapacityKWh || '-' }}</div>
    <div style="grid-column:1/-1"><strong>Variant Features:</strong> {{ variantFeatures?.length || 0 }}</div>
  </div>
</div>