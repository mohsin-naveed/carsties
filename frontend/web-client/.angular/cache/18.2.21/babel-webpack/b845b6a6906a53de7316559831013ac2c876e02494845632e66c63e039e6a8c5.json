{"ast":null,"code":"import { computed, effect, inject, signal } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { ListingsApiService } from '../listings/listings-api.service';\nimport { forkJoin } from 'rxjs';\nimport { MatFormFieldModule } from '@angular/material/form-field';\nimport { MatSelectModule } from '@angular/material/select';\nimport { MatIconModule } from '@angular/material/icon';\nimport { MatCardModule } from '@angular/material/card';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { MatProgressBarModule } from '@angular/material/progress-bar';\nimport { FormsModule } from '@angular/forms';\nimport { RouterModule } from '@angular/router';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nimport * as i2 from \"@angular/forms\";\nimport * as i3 from \"@angular/material/icon\";\nimport * as i4 from \"@angular/material/card\";\nimport * as i5 from \"@angular/material/progress-bar\";\nimport * as i6 from \"@angular/router\";\nconst _c0 = a0 => [\"/listings\", a0];\nfunction SearchComponent_option_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 39);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const option_r1 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", option_r1.value);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(option_r1.label);\n  }\n}\nfunction SearchComponent_div_41_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r2 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 25)(1, \"label\", 26)(2, \"input\", 27);\n    i0.ɵɵlistener(\"change\", function SearchComponent_div_41_Template_input_change_2_listener() {\n      const m_r3 = i0.ɵɵrestoreView(_r2).$implicit;\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.selectedMakeId.set(m_r3.id));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"span\", 28);\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(4, \"svg\", 29);\n    i0.ɵɵelement(5, \"path\", 30);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵnamespaceHTML();\n    i0.ɵɵelementStart(6, \"span\", 31);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const m_r3 = ctx.$implicit;\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"checked\", ctx_r3.selectedMakeId() === m_r3.id);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(m_r3.name);\n  }\n}\nfunction SearchComponent_div_57_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 25)(1, \"label\", 26)(2, \"input\", 27);\n    i0.ɵɵlistener(\"change\", function SearchComponent_div_57_Template_input_change_2_listener() {\n      const m_r6 = i0.ɵɵrestoreView(_r5).$implicit;\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.selectedModelId.set(m_r6.id));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"span\", 28);\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(4, \"svg\", 29);\n    i0.ɵɵelement(5, \"path\", 30);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵnamespaceHTML();\n    i0.ɵɵelementStart(6, \"span\", 31);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const m_r6 = ctx.$implicit;\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"checked\", ctx_r3.selectedModelId() === m_r6.id);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(m_r6.name);\n  }\n}\nfunction SearchComponent_div_73_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 25)(1, \"label\", 26)(2, \"input\", 27);\n    i0.ɵɵlistener(\"change\", function SearchComponent_div_73_Template_input_change_2_listener() {\n      const v_r8 = i0.ɵɵrestoreView(_r7).$implicit;\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.selectedVariantId.set(v_r8.id));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"span\", 28);\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(4, \"svg\", 29);\n    i0.ɵɵelement(5, \"path\", 30);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵnamespaceHTML();\n    i0.ɵɵelementStart(6, \"span\", 31);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const v_r8 = ctx.$implicit;\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"checked\", ctx_r3.selectedVariantId() === v_r8.id);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(v_r8.name);\n  }\n}\nfunction SearchComponent_div_89_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 25)(1, \"label\", 26)(2, \"input\", 27);\n    i0.ɵɵlistener(\"change\", function SearchComponent_div_89_Template_input_change_2_listener() {\n      const t_r10 = i0.ɵɵrestoreView(_r9).$implicit;\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.selectedTransmissionId.set(t_r10.id));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"span\", 28);\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(4, \"svg\", 29);\n    i0.ɵɵelement(5, \"path\", 30);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵnamespaceHTML();\n    i0.ɵɵelementStart(6, \"span\", 31);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const t_r10 = ctx.$implicit;\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"checked\", ctx_r3.selectedTransmissionId() === t_r10.id);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(t_r10.name);\n  }\n}\nfunction SearchComponent_div_105_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r11 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 25)(1, \"label\", 26)(2, \"input\", 27);\n    i0.ɵɵlistener(\"change\", function SearchComponent_div_105_Template_input_change_2_listener() {\n      const b_r12 = i0.ɵɵrestoreView(_r11).$implicit;\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.selectedBodyTypeId.set(b_r12.id));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"span\", 28);\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(4, \"svg\", 29);\n    i0.ɵɵelement(5, \"path\", 30);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵnamespaceHTML();\n    i0.ɵɵelementStart(6, \"span\", 31);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const b_r12 = ctx.$implicit;\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"checked\", ctx_r3.selectedBodyTypeId() === b_r12.id);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(b_r12.name);\n  }\n}\nfunction SearchComponent_div_121_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r13 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 25)(1, \"label\", 26)(2, \"input\", 27);\n    i0.ɵɵlistener(\"change\", function SearchComponent_div_121_Template_input_change_2_listener() {\n      const f_r14 = i0.ɵɵrestoreView(_r13).$implicit;\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.selectedFuelTypeId.set(f_r14.id));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"span\", 28);\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(4, \"svg\", 29);\n    i0.ɵɵelement(5, \"path\", 30);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵnamespaceHTML();\n    i0.ɵɵelementStart(6, \"span\", 31);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const f_r14 = ctx.$implicit;\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"checked\", ctx_r3.selectedFuelTypeId() === f_r14.id);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(f_r14.name);\n  }\n}\nfunction SearchComponent_mat_card_124_img_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"img\", 47);\n  }\n  if (rf & 2) {\n    const car_r15 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵproperty(\"src\", car_r15.images[0].thumbUrl || car_r15.images[0].url, i0.ɵɵsanitizeUrl);\n  }\n}\nfunction SearchComponent_mat_card_124_div_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 48)(1, \"mat-icon\");\n    i0.ɵɵtext(2, \"directions_car\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction SearchComponent_mat_card_124_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-card\", 40)(1, \"mat-card-header\")(2, \"mat-card-title\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"mat-card-subtitle\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(6, \"div\", 41);\n    i0.ɵɵtemplate(7, SearchComponent_mat_card_124_img_7_Template, 1, 1, \"img\", 42)(8, SearchComponent_mat_card_124_div_8_Template, 3, 0, \"div\", 43);\n    i0.ɵɵelementStart(9, \"span\", 44);\n    i0.ɵɵtext(10);\n    i0.ɵɵpipe(11, \"number\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(12, \"mat-card-content\")(13, \"div\", 45)(14, \"span\");\n    i0.ɵɵtext(15);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"span\");\n    i0.ɵɵtext(17);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(18, \"span\");\n    i0.ɵɵtext(19);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(20, \"span\");\n    i0.ɵɵtext(21);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(22, \"mat-card-actions\")(23, \"a\", 46);\n    i0.ɵɵtext(24, \"View Details\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const car_r15 = ctx.$implicit;\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(18, _c0, car_r15.id))(\"queryParamsHandling\", \"preserve\");\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(car_r15.title);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate3(\" \", car_r15.makeName || car_r15.makeId, \" \\u00B7 \", car_r15.modelName || car_r15.modelId, \" \\u00B7 \", car_r15.year, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", car_r15.images == null ? null : car_r15.images.length);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", !(car_r15.images == null ? null : car_r15.images.length));\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"R \", i0.ɵɵpipeBind2(11, 15, car_r15.price, \"1.0-0\"), \"\");\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate1(\"Variant: \", car_r15.variantName || car_r15.variantId, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Body: \", car_r15.bodyTypeName || car_r15.bodyTypeId, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Trans: \", car_r15.transmissionName || car_r15.transmissionId || \"-\", \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Fuel: \", car_r15.fuelTypeName || car_r15.fuelTypeId || \"-\", \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(20, _c0, car_r15.id))(\"queryParamsHandling\", \"preserve\");\n  }\n}\nfunction SearchComponent_div_125_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 49)(1, \"div\", 50)(2, \"h3\");\n    i0.ɵɵtext(3, \"No cars found\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"p\");\n    i0.ɵɵtext(5, \"Try adjusting your filters to see more results.\");\n    i0.ɵɵelementEnd()()();\n  }\n}\nfunction SearchComponent_div_126_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r16 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 51)(1, \"button\", 52);\n    i0.ɵɵlistener(\"click\", function SearchComponent_div_126_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r16);\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.prevPage());\n    });\n    i0.ɵɵtext(2, \"Previous\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"span\", 53);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"button\", 52);\n    i0.ɵɵlistener(\"click\", function SearchComponent_div_126_Template_button_click_5_listener() {\n      i0.ɵɵrestoreView(_r16);\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.nextPage());\n    });\n    i0.ɵɵtext(6, \"Next\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"disabled\", ctx_r3.page() === 1 || ctx_r3.loading());\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate2(\"Page \", ctx_r3.page(), \" of \", ctx_r3.totalPages(), \"\");\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"disabled\", ctx_r3.page() === ctx_r3.totalPages() || ctx_r3.loading());\n  }\n}\nfunction SearchComponent_mat_progress_bar_127_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"mat-progress-bar\", 54);\n  }\n}\nexport let SearchComponent = /*#__PURE__*/(() => {\n  class SearchComponent {\n    api = inject(ListingsApiService);\n    route = inject(ActivatedRoute);\n    router = inject(Router);\n    // Filters\n    makes = signal([]);\n    models = signal([]);\n    variants = signal([]);\n    transmissions = signal([]);\n    bodyTypes = signal([]);\n    fuelTypes = signal([]);\n    selectedMakeId = signal(null);\n    selectedModelId = signal(null);\n    selectedVariantId = signal(null);\n    selectedTransmissionId = signal(null);\n    selectedBodyTypeId = signal(null);\n    selectedFuelTypeId = signal(null);\n    // Listings + pagination\n    allListings = signal([]);\n    loading = signal(true);\n    page = signal(1);\n    pageSize = signal(12);\n    totalCount = signal(0);\n    totalPages = signal(1);\n    // Sorting\n    selectedSort = signal('price-asc');\n    sortOptions = [{\n      label: 'Price: Low to High',\n      value: 'price-asc'\n    }, {\n      label: 'Price: High to Low',\n      value: 'price-desc'\n    }, {\n      label: 'Year: Newest',\n      value: 'year-desc'\n    }, {\n      label: 'Year: Oldest',\n      value: 'year-asc'\n    }];\n    anyFilterActive = computed(() => !!(this.selectedMakeId() || this.selectedModelId() || this.selectedVariantId() || this.selectedTransmissionId() || this.selectedBodyTypeId() || this.selectedFuelTypeId()));\n    filteredListings = computed(() => {\n      // Server returns already filtered + sorted data for the current page\n      return this.allListings();\n    });\n    constructor() {\n      // Load initial data\n      this.fetch();\n      this.api.getMakes().subscribe(xs => this.makes.set(xs));\n      this.api.getOptions().subscribe(opts => {\n        this.transmissions.set(opts.transmissions);\n        this.bodyTypes.set(opts.bodyTypes);\n        this.fuelTypes.set(opts.fuelTypes);\n      });\n      // React to Make selection -> load Models\n      effect(() => {\n        const mk = this.selectedMakeId();\n        this.selectedModelId.set(null);\n        this.models.set([]);\n        this.variants.set([]);\n        this.selectedVariantId.set(null);\n        if (mk) {\n          this.api.getModels(mk).subscribe(xs => this.models.set(xs));\n        }\n      });\n      // React to Model selection -> load Variants across generations\n      effect(() => {\n        const mdl = this.selectedModelId();\n        this.variants.set([]);\n        this.selectedVariantId.set(null);\n        if (mdl) {\n          this.api.getGenerations(mdl).subscribe(gens => {\n            if (!gens || gens.length === 0) {\n              this.variants.set([]);\n              return;\n            }\n            const obs = gens.map(g => this.api.getVariantsByGeneration(g.id));\n            // Combine all variants from all generations\n            forkJoin(obs).subscribe({\n              next: results => {\n                this.variants.set(results.flat());\n              },\n              error: _ => {\n                this.variants.set([]);\n              }\n            });\n          });\n        }\n      });\n      // Read initial filters from URL\n      this.route.queryParamMap.subscribe(q => {\n        const getNum = key => {\n          const v = q.get(key);\n          return v ? Number(v) : null;\n        };\n        this.selectedMakeId.set(getNum('make'));\n        this.selectedModelId.set(getNum('model'));\n        this.selectedVariantId.set(getNum('variant'));\n        this.selectedTransmissionId.set(getNum('trans'));\n        this.selectedBodyTypeId.set(getNum('body'));\n        this.selectedFuelTypeId.set(getNum('fuel'));\n        const qpSort = q.get('sort');\n        if (qpSort) this.selectedSort.set(qpSort);\n        const qpPage = q.get('page');\n        this.page.set(qpPage ? Number(qpPage) : 1);\n      });\n      // Persist filters to URL when they change\n      effect(() => {\n        const qp = {\n          make: this.selectedMakeId(),\n          model: this.selectedModelId(),\n          variant: this.selectedVariantId(),\n          trans: this.selectedTransmissionId(),\n          body: this.selectedBodyTypeId(),\n          fuel: this.selectedFuelTypeId(),\n          sort: this.selectedSort(),\n          page: this.page()\n        };\n        // Remove nulls for cleaner URLs\n        Object.keys(qp).forEach(k => qp[k] === null && delete qp[k]);\n        this.router.navigate([], {\n          queryParams: qp,\n          queryParamsHandling: 'merge'\n        });\n      });\n      // Trigger server search on filters, sort, page or pageSize changes\n      effect(() => {\n        // Reset to first page when filters or sort change\n        const mk = this.selectedMakeId();\n        const md = this.selectedModelId();\n        const vr = this.selectedVariantId();\n        const tr = this.selectedTransmissionId();\n        const bt = this.selectedBodyTypeId();\n        const fu = this.selectedFuelTypeId();\n        const srt = this.selectedSort();\n        // Intentionally reference to create dependencies\n        void mk;\n        void md;\n        void vr;\n        void tr;\n        void bt;\n        void fu;\n        void srt;\n        this.page.set(1);\n      });\n      effect(() => {\n        const p = this.page();\n        const ps = this.pageSize();\n        void ps;\n        // Fetch page when page number changes\n        this.fetch();\n      });\n    }\n    fetch() {\n      const [sortBy, sortDirection] = this.mapSort(this.selectedSort());\n      const params = {\n        makeId: this.selectedMakeId() ?? undefined,\n        modelId: this.selectedModelId() ?? undefined,\n        variantId: this.selectedVariantId() ?? undefined,\n        transmissionId: this.selectedTransmissionId() ?? undefined,\n        bodyTypeId: this.selectedBodyTypeId() ?? undefined,\n        fuelTypeId: this.selectedFuelTypeId() ?? undefined,\n        page: this.page(),\n        pageSize: this.pageSize(),\n        sortBy,\n        sortDirection\n      };\n      this.loading.set(true);\n      this.api.searchListings(params).subscribe({\n        next: res => {\n          this.allListings.set(res.data);\n          this.totalCount.set(res.totalCount);\n          this.totalPages.set(res.totalPages);\n          this.loading.set(false);\n        },\n        error: _ => {\n          // Fallback to non-paginated endpoint to avoid empty UI if /search is unavailable\n          const fallbackParams = {\n            makeId: params.makeId,\n            modelId: params.modelId,\n            variantId: params.variantId,\n            transmissionId: params.transmissionId,\n            bodyTypeId: params.bodyTypeId,\n            fuelTypeId: params.fuelTypeId\n          };\n          this.api.getListings(fallbackParams).subscribe({\n            next: xs => {\n              this.allListings.set(xs);\n              this.totalCount.set(xs.length);\n              const pages = Math.max(1, Math.ceil(xs.length / this.pageSize()));\n              this.totalPages.set(pages);\n              // Slice client-side to current page for display\n              const start = (this.page() - 1) * this.pageSize();\n              const end = start + this.pageSize();\n              this.allListings.set(xs.slice(start, end));\n              this.loading.set(false);\n            },\n            error: __ => {\n              this.loading.set(false);\n            }\n          });\n        }\n      });\n    }\n    mapSort(v) {\n      switch (v) {\n        case 'price-asc':\n          return ['price', 'asc'];\n        case 'price-desc':\n          return ['price', 'desc'];\n        case 'year-asc':\n          return ['year', 'asc'];\n        case 'year-desc':\n          return ['year', 'desc'];\n        default:\n          return ['price', 'asc'];\n      }\n    }\n    prevPage() {\n      if (this.page() > 1) this.page.set(this.page() - 1);\n    }\n    nextPage() {\n      if (this.page() < this.totalPages()) this.page.set(this.page() + 1);\n    }\n    static ɵfac = function SearchComponent_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || SearchComponent)();\n    };\n    static ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: SearchComponent,\n      selectors: [[\"app-search\"]],\n      standalone: true,\n      features: [i0.ɵɵStandaloneFeature],\n      decls: 128,\n      vars: 19,\n      consts: [[1, \"find-car-container\"], [1, \"mobile-header-buttons\"], [1, \"mobile-filter-btn\"], [1, \"mobile-sort-btn\"], [1, \"header-section\"], [1, \"results-info\"], [1, \"results-title\"], [1, \"results-count\"], [1, \"sort-section\"], [\"for\", \"sort-select\", 1, \"sort-label\"], [\"id\", \"sort-select\", 1, \"sort-select\", 3, \"ngModelChange\", \"ngModel\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [1, \"main-content\"], [1, \"filter-sidebar\"], [1, \"filter-header\"], [1, \"filter-title\"], [\"width\", \"20\", \"height\", \"20\", \"viewBox\", \"0 0 24 24\", \"fill\", \"none\", 1, \"filter-icon\"], [\"d\", \"M22 3H2L10 12.46V19L14 21V12.46L22 3Z\", \"stroke\", \"currentColor\", \"stroke-width\", \"2\", \"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\"], [1, \"filter-content\"], [1, \"filter-section\"], [1, \"section-header\"], [1, \"section-title-container\"], [1, \"section-title\"], [1, \"section-content\", \"expanded\"], [1, \"options-container\"], [1, \"filter-option\"], [1, \"option-label\"], [\"type\", \"checkbox\", 1, \"filter-checkbox\", 3, \"change\", \"checked\"], [1, \"custom-checkbox\"], [\"width\", \"12\", \"height\", \"12\", \"viewBox\", \"0 0 24 24\", \"fill\", \"none\", 1, \"check-icon\"], [\"d\", \"M20 6L9 17L4 12\", \"stroke\", \"currentColor\", \"stroke-width\", \"3\", \"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\"], [1, \"option-text\"], [\"class\", \"filter-option\", 4, \"ngFor\", \"ngForOf\"], [1, \"car-results\"], [1, \"car-grid\"], [\"class\", \"car-card\", \"title\", \"View details\", 3, \"routerLink\", \"queryParamsHandling\", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"no-results\", 4, \"ngIf\"], [\"class\", \"pagination\", 4, \"ngIf\"], [\"mode\", \"indeterminate\", 4, \"ngIf\"], [3, \"value\"], [\"title\", \"View details\", 1, \"car-card\", 3, \"routerLink\", \"queryParamsHandling\"], [1, \"thumb-wrap\"], [\"class\", \"thumb\", \"alt\", \"car image\", 3, \"src\", 4, \"ngIf\"], [\"class\", \"thumb placeholder\", 4, \"ngIf\"], [1, \"price-badge\"], [1, \"specs\"], [\"mat-button\", \"\", 3, \"routerLink\", \"queryParamsHandling\"], [\"alt\", \"car image\", 1, \"thumb\", 3, \"src\"], [1, \"thumb\", \"placeholder\"], [1, \"no-results\"], [1, \"no-results-content\"], [1, \"pagination\"], [1, \"page-btn\", 3, \"click\", \"disabled\"], [1, \"page-info\"], [\"mode\", \"indeterminate\"]],\n      template: function SearchComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"button\", 2);\n          i0.ɵɵtext(3, \"Filters\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(4, \"button\", 3);\n          i0.ɵɵtext(5, \"Sort\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(6, \"div\", 4)(7, \"div\", 5)(8, \"h2\", 6);\n          i0.ɵɵtext(9, \"Find Your Perfect Car\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(10, \"p\", 7);\n          i0.ɵɵtext(11);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(12, \"div\", 8)(13, \"label\", 9);\n          i0.ɵɵtext(14, \"Sort by:\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(15, \"select\", 10);\n          i0.ɵɵlistener(\"ngModelChange\", function SearchComponent_Template_select_ngModelChange_15_listener($event) {\n            return ctx.selectedSort.set($event);\n          });\n          i0.ɵɵtemplate(16, SearchComponent_option_16_Template, 2, 2, \"option\", 11);\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(17, \"div\", 12)(18, \"aside\", 13)(19, \"div\", 13)(20, \"div\", 14)(21, \"h3\", 15);\n          i0.ɵɵnamespaceSVG();\n          i0.ɵɵelementStart(22, \"svg\", 16);\n          i0.ɵɵelement(23, \"path\", 17);\n          i0.ɵɵelementEnd();\n          i0.ɵɵtext(24, \" Filters \");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵnamespaceHTML();\n          i0.ɵɵelementStart(25, \"div\", 18)(26, \"div\", 19)(27, \"div\", 20)(28, \"div\", 21)(29, \"h4\", 22);\n          i0.ɵɵtext(30, \"Make\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(31, \"div\", 23)(32, \"div\", 24)(33, \"div\", 25)(34, \"label\", 26)(35, \"input\", 27);\n          i0.ɵɵlistener(\"change\", function SearchComponent_Template_input_change_35_listener() {\n            return ctx.selectedMakeId.set(null);\n          });\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(36, \"span\", 28);\n          i0.ɵɵnamespaceSVG();\n          i0.ɵɵelementStart(37, \"svg\", 29);\n          i0.ɵɵelement(38, \"path\", 30);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵnamespaceHTML();\n          i0.ɵɵelementStart(39, \"span\", 31);\n          i0.ɵɵtext(40, \"All\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵtemplate(41, SearchComponent_div_41_Template, 8, 2, \"div\", 32);\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(42, \"div\", 19)(43, \"div\", 20)(44, \"div\", 21)(45, \"h4\", 22);\n          i0.ɵɵtext(46, \"Model\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(47, \"div\", 23)(48, \"div\", 24)(49, \"div\", 25)(50, \"label\", 26)(51, \"input\", 27);\n          i0.ɵɵlistener(\"change\", function SearchComponent_Template_input_change_51_listener() {\n            return ctx.selectedModelId.set(null);\n          });\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(52, \"span\", 28);\n          i0.ɵɵnamespaceSVG();\n          i0.ɵɵelementStart(53, \"svg\", 29);\n          i0.ɵɵelement(54, \"path\", 30);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵnamespaceHTML();\n          i0.ɵɵelementStart(55, \"span\", 31);\n          i0.ɵɵtext(56, \"All\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵtemplate(57, SearchComponent_div_57_Template, 8, 2, \"div\", 32);\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(58, \"div\", 19)(59, \"div\", 20)(60, \"div\", 21)(61, \"h4\", 22);\n          i0.ɵɵtext(62, \"Variant\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(63, \"div\", 23)(64, \"div\", 24)(65, \"div\", 25)(66, \"label\", 26)(67, \"input\", 27);\n          i0.ɵɵlistener(\"change\", function SearchComponent_Template_input_change_67_listener() {\n            return ctx.selectedVariantId.set(null);\n          });\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(68, \"span\", 28);\n          i0.ɵɵnamespaceSVG();\n          i0.ɵɵelementStart(69, \"svg\", 29);\n          i0.ɵɵelement(70, \"path\", 30);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵnamespaceHTML();\n          i0.ɵɵelementStart(71, \"span\", 31);\n          i0.ɵɵtext(72, \"All\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵtemplate(73, SearchComponent_div_73_Template, 8, 2, \"div\", 32);\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(74, \"div\", 19)(75, \"div\", 20)(76, \"div\", 21)(77, \"h4\", 22);\n          i0.ɵɵtext(78, \"Transmission\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(79, \"div\", 23)(80, \"div\", 24)(81, \"div\", 25)(82, \"label\", 26)(83, \"input\", 27);\n          i0.ɵɵlistener(\"change\", function SearchComponent_Template_input_change_83_listener() {\n            return ctx.selectedTransmissionId.set(null);\n          });\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(84, \"span\", 28);\n          i0.ɵɵnamespaceSVG();\n          i0.ɵɵelementStart(85, \"svg\", 29);\n          i0.ɵɵelement(86, \"path\", 30);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵnamespaceHTML();\n          i0.ɵɵelementStart(87, \"span\", 31);\n          i0.ɵɵtext(88, \"All\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵtemplate(89, SearchComponent_div_89_Template, 8, 2, \"div\", 32);\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(90, \"div\", 19)(91, \"div\", 20)(92, \"div\", 21)(93, \"h4\", 22);\n          i0.ɵɵtext(94, \"Body Type\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(95, \"div\", 23)(96, \"div\", 24)(97, \"div\", 25)(98, \"label\", 26)(99, \"input\", 27);\n          i0.ɵɵlistener(\"change\", function SearchComponent_Template_input_change_99_listener() {\n            return ctx.selectedBodyTypeId.set(null);\n          });\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(100, \"span\", 28);\n          i0.ɵɵnamespaceSVG();\n          i0.ɵɵelementStart(101, \"svg\", 29);\n          i0.ɵɵelement(102, \"path\", 30);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵnamespaceHTML();\n          i0.ɵɵelementStart(103, \"span\", 31);\n          i0.ɵɵtext(104, \"All\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵtemplate(105, SearchComponent_div_105_Template, 8, 2, \"div\", 32);\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(106, \"div\", 19)(107, \"div\", 20)(108, \"div\", 21)(109, \"h4\", 22);\n          i0.ɵɵtext(110, \"Fuel Type\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(111, \"div\", 23)(112, \"div\", 24)(113, \"div\", 25)(114, \"label\", 26)(115, \"input\", 27);\n          i0.ɵɵlistener(\"change\", function SearchComponent_Template_input_change_115_listener() {\n            return ctx.selectedFuelTypeId.set(null);\n          });\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(116, \"span\", 28);\n          i0.ɵɵnamespaceSVG();\n          i0.ɵɵelementStart(117, \"svg\", 29);\n          i0.ɵɵelement(118, \"path\", 30);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵnamespaceHTML();\n          i0.ɵɵelementStart(119, \"span\", 31);\n          i0.ɵɵtext(120, \"All\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵtemplate(121, SearchComponent_div_121_Template, 8, 2, \"div\", 32);\n          i0.ɵɵelementEnd()()()()()();\n          i0.ɵɵelementStart(122, \"main\", 33)(123, \"div\", 34);\n          i0.ɵɵtemplate(124, SearchComponent_mat_card_124_Template, 25, 22, \"mat-card\", 35);\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(125, SearchComponent_div_125_Template, 6, 0, \"div\", 36)(126, SearchComponent_div_126_Template, 7, 4, \"div\", 37)(127, SearchComponent_mat_progress_bar_127_Template, 1, 0, \"mat-progress-bar\", 38);\n          i0.ɵɵelementEnd()()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(11);\n          i0.ɵɵtextInterpolate1(\"Showing \", ctx.totalCount(), \" cars\");\n          i0.ɵɵadvance(4);\n          i0.ɵɵproperty(\"ngModel\", ctx.selectedSort());\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngForOf\", ctx.sortOptions);\n          i0.ɵɵadvance(19);\n          i0.ɵɵproperty(\"checked\", !ctx.selectedMakeId());\n          i0.ɵɵadvance(6);\n          i0.ɵɵproperty(\"ngForOf\", ctx.makes());\n          i0.ɵɵadvance(10);\n          i0.ɵɵproperty(\"checked\", !ctx.selectedModelId());\n          i0.ɵɵadvance(6);\n          i0.ɵɵproperty(\"ngForOf\", ctx.models());\n          i0.ɵɵadvance(10);\n          i0.ɵɵproperty(\"checked\", !ctx.selectedVariantId());\n          i0.ɵɵadvance(6);\n          i0.ɵɵproperty(\"ngForOf\", ctx.variants());\n          i0.ɵɵadvance(10);\n          i0.ɵɵproperty(\"checked\", !ctx.selectedTransmissionId());\n          i0.ɵɵadvance(6);\n          i0.ɵɵproperty(\"ngForOf\", ctx.transmissions());\n          i0.ɵɵadvance(10);\n          i0.ɵɵproperty(\"checked\", !ctx.selectedBodyTypeId());\n          i0.ɵɵadvance(6);\n          i0.ɵɵproperty(\"ngForOf\", ctx.bodyTypes());\n          i0.ɵɵadvance(10);\n          i0.ɵɵproperty(\"checked\", !ctx.selectedFuelTypeId());\n          i0.ɵɵadvance(6);\n          i0.ɵɵproperty(\"ngForOf\", ctx.fuelTypes());\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"ngForOf\", ctx.filteredListings());\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", !ctx.loading() && ctx.totalCount() === 0);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", ctx.totalPages() > 1);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", ctx.loading());\n        }\n      },\n      dependencies: [CommonModule, i1.NgForOf, i1.NgIf, i1.DecimalPipe, FormsModule, i2.NgSelectOption, i2.ɵNgSelectMultipleOption, i2.SelectControlValueAccessor, i2.NgControlStatus, i2.NgModel, MatFormFieldModule, MatSelectModule, MatIconModule, i3.MatIcon, MatCardModule, i4.MatCard, i4.MatCardActions, i4.MatCardContent, i4.MatCardHeader, i4.MatCardSubtitle, i4.MatCardTitle, MatProgressBarModule, i5.MatProgressBar, RouterModule, i6.RouterLink],\n      styles: [\".find-car-container[_ngcontent-%COMP%]{max-width:1400px;margin:0 auto;padding:20px;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif}.mobile-header-buttons[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;padding:0 8px}.mobile-filter-btn[_ngcontent-%COMP%], .mobile-sort-btn[_ngcontent-%COMP%]{flex:1 1 50%;padding:12px 0;font-size:16px;font-weight:600;border:none;background:#f8f9fa;color:#007bff;border-radius:8px;margin:0 4px;box-shadow:0 1px 3px #0000000a}.mobile-filter-btn[_ngcontent-%COMP%]{text-align:left}.mobile-sort-btn[_ngcontent-%COMP%]{text-align:right}.header-section[_ngcontent-%COMP%]{display:none}@media (min-width: 768px){.mobile-header-buttons[_ngcontent-%COMP%]{display:none}.header-section[_ngcontent-%COMP%]{display:flex}}.header-section[_ngcontent-%COMP%]{justify-content:space-between;align-items:center;margin-bottom:30px;padding:20px;background-color:#f8f9fa;border-radius:8px;box-shadow:0 2px 4px #0000001a}.results-title[_ngcontent-%COMP%]{margin:0 0 8px;font-size:28px;font-weight:700;color:#2c3e50}.results-count[_ngcontent-%COMP%]{margin:0;color:#6c757d;font-size:14px}.sort-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.sort-label[_ngcontent-%COMP%]{font-weight:600;color:#495057}.sort-select[_ngcontent-%COMP%]{padding:8px 12px;border:2px solid #dee2e6;border-radius:6px;font-size:14px;background-color:#fff;cursor:pointer;transition:all .3s ease}.sort-select[_ngcontent-%COMP%]:hover{border-color:#007bff}.sort-select[_ngcontent-%COMP%]:focus{outline:none;border-color:#007bff;box-shadow:0 0 0 3px #007bff1a}.main-content[_ngcontent-%COMP%]{display:grid;grid-template-columns:300px 1fr;gap:30px}.filter-sidebar[_ngcontent-%COMP%]{background-color:#fff;border-radius:8px;box-shadow:0 2px 8px #0000001a;height:fit-content;position:sticky;top:20px}@media (max-width: 767px){.filter-sidebar[_ngcontent-%COMP%]{display:none!important}}.car-results[_ngcontent-%COMP%]{min-height:600px}.car-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(350px,1fr));gap:24px;margin-bottom:40px}.no-results[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;min-height:400px;text-align:center}.no-results-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:24px;color:#6c757d;margin-bottom:16px}.no-results-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#adb5bd;font-size:16px}.car-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;cursor:pointer}.thumb-wrap[_ngcontent-%COMP%]{position:relative;width:100%;aspect-ratio:16/9}.thumb[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.thumb.placeholder[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;background:#f2f2f2;color:#777;width:100%;height:100%}.price-badge[_ngcontent-%COMP%]{position:absolute;right:8px;top:8px;background:#000000b3;color:#fff;padding:4px 8px;border-radius:12px;font-weight:600}.specs[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:8px;margin-top:8px}.full[_ngcontent-%COMP%]{width:100%}.muted[_ngcontent-%COMP%]{color:#0009}.filter-sidebar[_ngcontent-%COMP%]   .filter-sidebar[_ngcontent-%COMP%]{background:#fff;border-radius:8px;overflow:hidden}.filter-header[_ngcontent-%COMP%]{padding:20px;border-bottom:2px solid #e9ecef;background:linear-gradient(135deg,#007bff,#0056b3);color:#fff}.filter-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin:0 0 8px;font-size:18px;font-weight:700}.filter-icon[_ngcontent-%COMP%]{color:#ffffffe6}.filter-content[_ngcontent-%COMP%]{max-height:calc(100vh - 200px);overflow-y:auto}.filter-section[_ngcontent-%COMP%]{border-bottom:1px solid #e9ecef}.filter-section[_ngcontent-%COMP%]:last-child{border-bottom:none}.section-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:16px 20px;cursor:pointer;background:#f8f9fa;transition:all .3s ease;border-bottom:1px solid #e9ecef}.section-title[_ngcontent-%COMP%]{margin:0;font-size:15px;font-weight:600;color:#2c3e50}.section-content[_ngcontent-%COMP%]{max-height:0;overflow:hidden;transition:max-height .3s ease}.section-content.expanded[_ngcontent-%COMP%]{max-height:400px;overflow-y:auto}.options-container[_ngcontent-%COMP%]{padding:16px 20px}.filter-option[_ngcontent-%COMP%]{margin-bottom:12px}.option-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;cursor:pointer;font-size:14px;line-height:1.4;transition:all .3s ease;padding:4px 0}.filter-checkbox[_ngcontent-%COMP%]{display:none}.custom-checkbox[_ngcontent-%COMP%]{position:relative;width:18px;height:18px;border:2px solid #dee2e6;border-radius:3px;background:#fff;display:flex;align-items:center;justify-content:center;transition:all .3s ease;flex-shrink:0}.filter-checkbox[_ngcontent-%COMP%]:checked + .custom-checkbox[_ngcontent-%COMP%]{background:#007bff;border-color:#007bff}.filter-checkbox[_ngcontent-%COMP%]:checked + .custom-checkbox[_ngcontent-%COMP%]   .check-icon[_ngcontent-%COMP%]{opacity:1;transform:scale(1)}.check-icon[_ngcontent-%COMP%]{color:#fff;opacity:0;transform:scale(0);transition:all .3s ease}.option-text[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;justify-content:space-between;gap:8px}\"]\n    });\n  }\n  return SearchComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}