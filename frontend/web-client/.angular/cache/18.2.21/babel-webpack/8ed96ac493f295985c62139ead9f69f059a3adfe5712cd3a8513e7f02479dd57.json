{"ast":null,"code":"import { inject } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { ListingsApiService } from '../listings/listings-api.service';\nimport { BehaviorSubject, combineLatest } from 'rxjs';\nimport { map, switchMap, shareReplay, distinctUntilChanged, debounceTime, catchError, startWith, tap, take } from 'rxjs/operators';\nimport { MatFormFieldModule } from '@angular/material/form-field';\nimport { MatSelectModule } from '@angular/material/select';\nimport { MatIconModule } from '@angular/material/icon';\nimport { MatCardModule } from '@angular/material/card';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { MatProgressBarModule } from '@angular/material/progress-bar';\nimport { FormsModule } from '@angular/forms';\nimport { RouterModule } from '@angular/router';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nimport * as i2 from \"@angular/forms\";\nimport * as i3 from \"@angular/material/icon\";\nimport * as i4 from \"@angular/material/progress-bar\";\nimport * as i5 from \"@angular/router\";\nconst _c0 = () => [];\nconst _c1 = a0 => [\"/listings\", a0];\nfunction SearchComponent_option_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 46);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const option_r1 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", option_r1.value);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(option_r1.label);\n  }\n}\nfunction SearchComponent_div_21_button_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r2 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 49);\n    i0.ɵɵpipe(1, \"async\");\n    i0.ɵɵlistener(\"click\", function SearchComponent_div_21_button_1_Template_button_click_0_listener() {\n      const option_r3 = i0.ɵɵrestoreView(_r2).$implicit;\n      const ctx_r3 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r3.setSort(option_r3.value));\n    });\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const option_r3 = ctx.$implicit;\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵclassProp(\"active\", i0.ɵɵpipeBind1(1, 3, ctx_r3.sort$) === option_r3.value);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(option_r3.label);\n  }\n}\nfunction SearchComponent_div_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 47);\n    i0.ɵɵtemplate(1, SearchComponent_div_21_button_1_Template, 3, 5, \"button\", 48);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngForOf\", ctx_r3.sortOptions);\n  }\n}\nfunction SearchComponent_mat_icon_27_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-icon\");\n    i0.ɵɵtext(1, \"grid_view\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction SearchComponent_mat_icon_29_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-icon\");\n    i0.ɵɵtext(1, \"list\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction SearchComponent_div_41_span_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"span\", 52)(1, \"span\", 53);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"button\", 54);\n    i0.ɵɵlistener(\"click\", function SearchComponent_div_41_span_1_Template_button_click_3_listener() {\n      const c_r6 = i0.ɵɵrestoreView(_r5).$implicit;\n      const ctx_r3 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r3.removeChip(c_r6));\n    });\n    i0.ɵɵelementStart(4, \"mat-icon\");\n    i0.ɵɵtext(5, \"close\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const c_r6 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(c_r6.label);\n  }\n}\nfunction SearchComponent_div_41_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 50);\n    i0.ɵɵtemplate(1, SearchComponent_div_41_span_1_Template, 6, 1, \"span\", 51);\n    i0.ɵɵpipe(2, \"async\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(2, 1, ctx_r3.activeFilterChips$));\n  }\n}\nfunction SearchComponent_mat_icon_51_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-icon\");\n    i0.ɵɵtext(1, \"expand_more\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction SearchComponent_mat_icon_53_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-icon\");\n    i0.ɵɵtext(1, \"expand_less\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction SearchComponent_div_58_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 55)(1, \"label\", 56)(2, \"input\", 57);\n    i0.ɵɵpipe(3, \"async\");\n    i0.ɵɵlistener(\"change\", function SearchComponent_div_58_Template_input_change_2_listener() {\n      const m_r8 = i0.ɵɵrestoreView(_r7).$implicit;\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.toggleMake(m_r8.code));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"span\", 58);\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(5, \"svg\", 59);\n    i0.ɵɵelement(6, \"path\", 60);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵnamespaceHTML();\n    i0.ɵɵelementStart(7, \"span\", 61);\n    i0.ɵɵtext(8);\n    i0.ɵɵelementStart(9, \"span\", 62);\n    i0.ɵɵtext(10);\n    i0.ɵɵpipe(11, \"async\");\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    let tmp_2_0;\n    let tmp_4_0;\n    const m_r8 = ctx.$implicit;\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"checked\", (tmp_2_0 = i0.ɵɵpipeBind1(3, 3, ctx_r3.selectedMakeCodes$)) == null ? null : tmp_2_0.includes(m_r8.code));\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate1(\"\", m_r8.name, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"(\", (tmp_4_0 = (tmp_4_0 = i0.ɵɵpipeBind1(11, 5, ctx_r3.makeCounts$)) == null ? null : tmp_4_0.get(m_r8.code)) !== null && tmp_4_0 !== undefined ? tmp_4_0 : 0, \")\");\n  }\n}\nfunction SearchComponent_mat_icon_67_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-icon\");\n    i0.ɵɵtext(1, \"expand_more\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction SearchComponent_mat_icon_69_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-icon\");\n    i0.ɵɵtext(1, \"expand_less\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction SearchComponent_div_74_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 55)(1, \"label\", 56)(2, \"input\", 57);\n    i0.ɵɵpipe(3, \"async\");\n    i0.ɵɵlistener(\"change\", function SearchComponent_div_74_Template_input_change_2_listener() {\n      const m_r10 = i0.ɵɵrestoreView(_r9).$implicit;\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.toggleModel(m_r10.code));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"span\", 58);\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(5, \"svg\", 59);\n    i0.ɵɵelement(6, \"path\", 60);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵnamespaceHTML();\n    i0.ɵɵelementStart(7, \"span\", 61);\n    i0.ɵɵtext(8);\n    i0.ɵɵelementStart(9, \"span\", 62);\n    i0.ɵɵtext(10);\n    i0.ɵɵpipe(11, \"async\");\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    let tmp_2_0;\n    let tmp_4_0;\n    const m_r10 = ctx.$implicit;\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"checked\", (tmp_2_0 = i0.ɵɵpipeBind1(3, 3, ctx_r3.selectedModelCodes$)) == null ? null : tmp_2_0.includes(m_r10.code));\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate1(\"\", m_r10.name, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"(\", (tmp_4_0 = (tmp_4_0 = i0.ɵɵpipeBind1(11, 5, ctx_r3.modelCounts$)) == null ? null : tmp_4_0.get(m_r10.code)) !== null && tmp_4_0 !== undefined ? tmp_4_0 : 0, \")\");\n  }\n}\nfunction SearchComponent_mat_icon_83_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-icon\");\n    i0.ɵɵtext(1, \"expand_more\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction SearchComponent_mat_icon_85_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-icon\");\n    i0.ɵɵtext(1, \"expand_less\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction SearchComponent_option_97_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 46);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"number\");\n    i0.ɵɵpipe(3, \"async\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    let tmp_3_0;\n    const p_r11 = ctx.$implicit;\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"value\", p_r11);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate2(\"\\u00A3\", i0.ɵɵpipeBind2(2, 3, p_r11, \"1.0-0\"), \" (\", (tmp_3_0 = (tmp_3_0 = i0.ɵɵpipeBind1(3, 6, ctx_r3.fromPriceCumulativeCounts$)) == null ? null : tmp_3_0.get(p_r11)) !== null && tmp_3_0 !== undefined ? tmp_3_0 : 0, \")\");\n  }\n}\nfunction SearchComponent_option_108_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 46);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"number\");\n    i0.ɵɵpipe(3, \"async\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    let tmp_3_0;\n    const p_r12 = ctx.$implicit;\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"value\", p_r12);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate2(\"\\u00A3\", i0.ɵɵpipeBind2(2, 3, p_r12, \"1.0-0\"), \" (\", (tmp_3_0 = (tmp_3_0 = i0.ɵɵpipeBind1(3, 6, ctx_r3.toPriceCumulativeCounts$)) == null ? null : tmp_3_0.get(p_r12)) !== null && tmp_3_0 !== undefined ? tmp_3_0 : 0, \")\");\n  }\n}\nfunction SearchComponent_mat_icon_117_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-icon\");\n    i0.ɵɵtext(1, \"expand_more\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction SearchComponent_mat_icon_119_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-icon\");\n    i0.ɵɵtext(1, \"expand_less\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction SearchComponent_option_131_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 46);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"async\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    let tmp_3_0;\n    const y_r13 = ctx.$implicit;\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"value\", y_r13);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate2(\"\", y_r13, \" (\", (tmp_3_0 = (tmp_3_0 = i0.ɵɵpipeBind1(2, 3, ctx_r3.fromYearCumulativeCounts$)) == null ? null : tmp_3_0.get(y_r13)) !== null && tmp_3_0 !== undefined ? tmp_3_0 : 0, \")\");\n  }\n}\nfunction SearchComponent_option_140_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 46);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"async\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    let tmp_3_0;\n    const y_r14 = ctx.$implicit;\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"value\", y_r14);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate2(\"\", y_r14, \" (\", (tmp_3_0 = (tmp_3_0 = i0.ɵɵpipeBind1(2, 3, ctx_r3.toYearCumulativeCounts$)) == null ? null : tmp_3_0.get(y_r14)) !== null && tmp_3_0 !== undefined ? tmp_3_0 : 0, \")\");\n  }\n}\nfunction SearchComponent_mat_icon_149_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-icon\");\n    i0.ɵɵtext(1, \"expand_more\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction SearchComponent_mat_icon_151_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-icon\");\n    i0.ɵɵtext(1, \"expand_less\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction SearchComponent_option_163_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 46);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"number\");\n    i0.ɵɵpipe(3, \"async\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    let tmp_3_0;\n    const m_r15 = ctx.$implicit;\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"value\", m_r15);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate2(\"\", i0.ɵɵpipeBind2(2, 3, m_r15, \"1.0-0\"), \" miles (\", (tmp_3_0 = (tmp_3_0 = i0.ɵɵpipeBind1(3, 6, ctx_r3.fromMileageDisplayCounts$)) == null ? null : tmp_3_0.get(m_r15)) !== null && tmp_3_0 !== undefined ? tmp_3_0 : 0, \")\");\n  }\n}\nfunction SearchComponent_option_172_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 46);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"number\");\n    i0.ɵɵpipe(3, \"async\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    let tmp_3_0;\n    const m_r16 = ctx.$implicit;\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"value\", m_r16);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate2(\"\", i0.ɵɵpipeBind2(2, 3, m_r16, \"1.0-0\"), \" miles (\", (tmp_3_0 = (tmp_3_0 = i0.ɵɵpipeBind1(3, 6, ctx_r3.toMileageDisplayCounts$)) == null ? null : tmp_3_0.get(m_r16)) !== null && tmp_3_0 !== undefined ? tmp_3_0 : 0, \")\");\n  }\n}\nfunction SearchComponent_mat_icon_181_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-icon\");\n    i0.ɵɵtext(1, \"expand_more\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction SearchComponent_mat_icon_183_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-icon\");\n    i0.ɵɵtext(1, \"expand_less\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction SearchComponent_div_188_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r17 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 55)(1, \"label\", 56)(2, \"input\", 57);\n    i0.ɵɵpipe(3, \"async\");\n    i0.ɵɵlistener(\"change\", function SearchComponent_div_188_Template_input_change_2_listener() {\n      const t_r18 = i0.ɵɵrestoreView(_r17).$implicit;\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.toggleTransmission(t_r18.code));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"span\", 58);\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(5, \"svg\", 59);\n    i0.ɵɵelement(6, \"path\", 60);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵnamespaceHTML();\n    i0.ɵɵelementStart(7, \"span\", 61);\n    i0.ɵɵtext(8);\n    i0.ɵɵelementStart(9, \"span\", 62);\n    i0.ɵɵtext(10);\n    i0.ɵɵpipe(11, \"async\");\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    let tmp_2_0;\n    let tmp_4_0;\n    const t_r18 = ctx.$implicit;\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"checked\", (tmp_2_0 = i0.ɵɵpipeBind1(3, 3, ctx_r3.selectedTransmissionCodes$)) == null ? null : tmp_2_0.includes(t_r18.code));\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate1(\"\", t_r18.name, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"(\", (tmp_4_0 = (tmp_4_0 = i0.ɵɵpipeBind1(11, 5, ctx_r3.transmissionCounts$)) == null ? null : tmp_4_0.get(t_r18.code)) !== null && tmp_4_0 !== undefined ? tmp_4_0 : 0, \")\");\n  }\n}\nfunction SearchComponent_mat_icon_197_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-icon\");\n    i0.ɵɵtext(1, \"expand_more\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction SearchComponent_mat_icon_199_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-icon\");\n    i0.ɵɵtext(1, \"expand_less\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction SearchComponent_div_204_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r19 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 55)(1, \"label\", 56)(2, \"input\", 57);\n    i0.ɵɵpipe(3, \"async\");\n    i0.ɵɵlistener(\"change\", function SearchComponent_div_204_Template_input_change_2_listener() {\n      const b_r20 = i0.ɵɵrestoreView(_r19).$implicit;\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.toggleBodyType(b_r20.code));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"span\", 58);\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(5, \"svg\", 59);\n    i0.ɵɵelement(6, \"path\", 60);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵnamespaceHTML();\n    i0.ɵɵelementStart(7, \"span\", 61);\n    i0.ɵɵtext(8);\n    i0.ɵɵelementStart(9, \"span\", 62);\n    i0.ɵɵtext(10);\n    i0.ɵɵpipe(11, \"async\");\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    let tmp_2_0;\n    let tmp_4_0;\n    const b_r20 = ctx.$implicit;\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"checked\", (tmp_2_0 = i0.ɵɵpipeBind1(3, 3, ctx_r3.selectedBodyTypeCodes$)) == null ? null : tmp_2_0.includes(b_r20.code));\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate1(\"\", b_r20.name, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"(\", (tmp_4_0 = (tmp_4_0 = i0.ɵɵpipeBind1(11, 5, ctx_r3.bodyCounts$)) == null ? null : tmp_4_0.get(b_r20.code)) !== null && tmp_4_0 !== undefined ? tmp_4_0 : 0, \")\");\n  }\n}\nfunction SearchComponent_mat_icon_213_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-icon\");\n    i0.ɵɵtext(1, \"expand_more\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction SearchComponent_mat_icon_215_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-icon\");\n    i0.ɵɵtext(1, \"expand_less\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction SearchComponent_div_220_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r21 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 55)(1, \"label\", 56)(2, \"input\", 57);\n    i0.ɵɵpipe(3, \"async\");\n    i0.ɵɵlistener(\"change\", function SearchComponent_div_220_Template_input_change_2_listener() {\n      const f_r22 = i0.ɵɵrestoreView(_r21).$implicit;\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.toggleFuelType(f_r22.code));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"span\", 58);\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(5, \"svg\", 59);\n    i0.ɵɵelement(6, \"path\", 60);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵnamespaceHTML();\n    i0.ɵɵelementStart(7, \"span\", 61);\n    i0.ɵɵtext(8);\n    i0.ɵɵelementStart(9, \"span\", 62);\n    i0.ɵɵtext(10);\n    i0.ɵɵpipe(11, \"async\");\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    let tmp_2_0;\n    let tmp_4_0;\n    const f_r22 = ctx.$implicit;\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"checked\", (tmp_2_0 = i0.ɵɵpipeBind1(3, 3, ctx_r3.selectedFuelTypeCodes$)) == null ? null : tmp_2_0.includes(f_r22.code));\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate1(\"\", f_r22.name, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"(\", (tmp_4_0 = (tmp_4_0 = i0.ɵɵpipeBind1(11, 5, ctx_r3.fuelCounts$)) == null ? null : tmp_4_0.get(f_r22.code)) !== null && tmp_4_0 !== undefined ? tmp_4_0 : 0, \")\");\n  }\n}\nfunction SearchComponent_mat_icon_229_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-icon\");\n    i0.ɵɵtext(1, \"expand_more\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction SearchComponent_mat_icon_231_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-icon\");\n    i0.ɵɵtext(1, \"expand_less\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction SearchComponent_div_236_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r23 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 55)(1, \"label\", 56)(2, \"input\", 57);\n    i0.ɵɵpipe(3, \"async\");\n    i0.ɵɵlistener(\"change\", function SearchComponent_div_236_Template_input_change_2_listener() {\n      const s_r24 = i0.ɵɵrestoreView(_r23).$implicit;\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.toggleSeat(s_r24));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"span\", 58);\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(5, \"svg\", 59);\n    i0.ɵɵelement(6, \"path\", 60);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵnamespaceHTML();\n    i0.ɵɵelementStart(7, \"span\", 61);\n    i0.ɵɵtext(8);\n    i0.ɵɵelementStart(9, \"span\", 62);\n    i0.ɵɵtext(10);\n    i0.ɵɵpipe(11, \"async\");\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    let tmp_2_0;\n    let tmp_4_0;\n    const s_r24 = ctx.$implicit;\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"checked\", (tmp_2_0 = i0.ɵɵpipeBind1(3, 3, ctx_r3.selectedSeats$)) == null ? null : tmp_2_0.includes(s_r24));\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate1(\"\", s_r24, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"(\", (tmp_4_0 = (tmp_4_0 = i0.ɵɵpipeBind1(11, 5, ctx_r3.seatsCounts$)) == null ? null : tmp_4_0.get(s_r24)) !== null && tmp_4_0 !== undefined ? tmp_4_0 : 0, \")\");\n  }\n}\nfunction SearchComponent_mat_icon_245_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-icon\");\n    i0.ɵɵtext(1, \"expand_more\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction SearchComponent_mat_icon_247_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-icon\");\n    i0.ɵɵtext(1, \"expand_less\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction SearchComponent_div_252_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r25 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 55)(1, \"label\", 56)(2, \"input\", 57);\n    i0.ɵɵpipe(3, \"async\");\n    i0.ɵɵlistener(\"change\", function SearchComponent_div_252_Template_input_change_2_listener() {\n      const d_r26 = i0.ɵɵrestoreView(_r25).$implicit;\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.toggleDoor(d_r26));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"span\", 58);\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(5, \"svg\", 59);\n    i0.ɵɵelement(6, \"path\", 60);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵnamespaceHTML();\n    i0.ɵɵelementStart(7, \"span\", 61);\n    i0.ɵɵtext(8);\n    i0.ɵɵelementStart(9, \"span\", 62);\n    i0.ɵɵtext(10);\n    i0.ɵɵpipe(11, \"async\");\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    let tmp_2_0;\n    let tmp_4_0;\n    const d_r26 = ctx.$implicit;\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"checked\", (tmp_2_0 = i0.ɵɵpipeBind1(3, 3, ctx_r3.selectedDoors$)) == null ? null : tmp_2_0.includes(d_r26));\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate1(\"\", d_r26, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"(\", (tmp_4_0 = (tmp_4_0 = i0.ɵɵpipeBind1(11, 5, ctx_r3.doorsCounts$)) == null ? null : tmp_4_0.get(d_r26)) !== null && tmp_4_0 !== undefined ? tmp_4_0 : 0, \")\");\n  }\n}\nfunction SearchComponent_div_262_span_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r27 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"span\", 52)(1, \"span\", 53);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"button\", 54);\n    i0.ɵɵlistener(\"click\", function SearchComponent_div_262_span_1_Template_button_click_3_listener() {\n      const c_r28 = i0.ɵɵrestoreView(_r27).$implicit;\n      const ctx_r3 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r3.removeChip(c_r28));\n    });\n    i0.ɵɵelementStart(4, \"mat-icon\");\n    i0.ɵɵtext(5, \"close\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const c_r28 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(c_r28.label);\n  }\n}\nfunction SearchComponent_div_262_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 63);\n    i0.ɵɵtemplate(1, SearchComponent_div_262_span_1_Template, 6, 1, \"span\", 51);\n    i0.ɵɵpipe(2, \"async\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(2, 1, ctx_r3.activeFilterChips$));\n  }\n}\nfunction SearchComponent_div_266_ng_container_3_button_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r29 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 81);\n    i0.ɵɵlistener(\"click\", function SearchComponent_div_266_ng_container_3_button_2_Template_button_click_0_listener($event) {\n      i0.ɵɵrestoreView(_r29);\n      const car_r30 = i0.ɵɵnextContext(2).$implicit;\n      const ctx_r3 = i0.ɵɵnextContext();\n      $event.preventDefault();\n      $event.stopPropagation();\n      return i0.ɵɵresetView(ctx_r3.prev(car_r30));\n    });\n    i0.ɵɵtext(1, \"\\u2039\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction SearchComponent_div_266_ng_container_3_button_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r31 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 82);\n    i0.ɵɵlistener(\"click\", function SearchComponent_div_266_ng_container_3_button_3_Template_button_click_0_listener($event) {\n      i0.ɵɵrestoreView(_r31);\n      const car_r30 = i0.ɵɵnextContext(2).$implicit;\n      const ctx_r3 = i0.ɵɵnextContext();\n      $event.preventDefault();\n      $event.stopPropagation();\n      return i0.ɵɵresetView(ctx_r3.next(car_r30));\n    });\n    i0.ɵɵtext(1, \"\\u203A\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction SearchComponent_div_266_ng_container_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelement(1, \"img\", 78);\n    i0.ɵɵtemplate(2, SearchComponent_div_266_ng_container_3_button_2_Template, 2, 0, \"button\", 79)(3, SearchComponent_div_266_ng_container_3_button_3_Template, 2, 0, \"button\", 80);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    let tmp_4_0;\n    let tmp_5_0;\n    let tmp_6_0;\n    const car_r30 = i0.ɵɵnextContext().$implicit;\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"src\", (car_r30.images == null ? null : (tmp_4_0 = car_r30.images[ctx_r3.currentIndex(car_r30)]) == null ? null : tmp_4_0.thumbUrl) || (car_r30.images == null ? null : (tmp_4_0 = car_r30.images[ctx_r3.currentIndex(car_r30)]) == null ? null : tmp_4_0.url) || (car_r30.images == null ? null : car_r30.images[0] == null ? null : car_r30.images[0].thumbUrl) || (car_r30.images == null ? null : car_r30.images[0] == null ? null : car_r30.images[0].url), i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ((tmp_5_0 = car_r30.images == null ? null : car_r30.images.length) !== null && tmp_5_0 !== undefined ? tmp_5_0 : 0) > 1);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ((tmp_6_0 = car_r30.images == null ? null : car_r30.images.length) !== null && tmp_6_0 !== undefined ? tmp_6_0 : 0) > 1);\n  }\n}\nfunction SearchComponent_div_266_ng_template_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 83)(1, \"mat-icon\");\n    i0.ɵɵtext(2, \"directions_car\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction SearchComponent_div_266_span_20_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 72);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const f_r32 = ctx.ngIf;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(f_r32);\n  }\n}\nfunction SearchComponent_div_266_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 64);\n    i0.ɵɵpipe(1, \"async\");\n    i0.ɵɵelementStart(2, \"div\", 65);\n    i0.ɵɵtemplate(3, SearchComponent_div_266_ng_container_3_Template, 4, 3, \"ng-container\", 66)(4, SearchComponent_div_266_ng_template_4_Template, 3, 0, \"ng-template\", null, 0, i0.ɵɵtemplateRefExtractor);\n    i0.ɵɵelementStart(6, \"div\", 67);\n    i0.ɵɵtext(7);\n    i0.ɵɵpipe(8, \"number\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(9, \"div\", 68)(10, \"div\", 69);\n    i0.ɵɵtext(11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"div\", 70);\n    i0.ɵɵtext(13);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"div\", 71)(15, \"span\", 72);\n    i0.ɵɵtext(16);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"span\", 72);\n    i0.ɵɵtext(18);\n    i0.ɵɵpipe(19, \"number\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(20, SearchComponent_div_266_span_20_Template, 2, 1, \"span\", 73);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(21, \"div\", 74)(22, \"div\", 75);\n    i0.ɵɵtext(23);\n    i0.ɵɵpipe(24, \"number\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(25, \"div\", 76)(26, \"a\", 77);\n    i0.ɵɵtext(27, \"View Details\");\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const car_r30 = ctx.$implicit;\n    const noImage_r33 = i0.ɵɵreference(5);\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵclassProp(\"list\", i0.ɵɵpipeBind1(1, 16, ctx_r3.view$) === \"list\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(26, _c1, car_r30.id))(\"queryParamsHandling\", \"preserve\");\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", car_r30.images == null ? null : car_r30.images.length)(\"ngIfElse\", noImage_r33);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\"\\u00A3\", i0.ɵɵpipeBind2(8, 18, car_r30.price, \"1.0-0\"), \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate2(\"\", car_r30.makeName || car_r30.makeId, \" \", car_r30.modelName || car_r30.modelId, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(car_r30.variantName || car_r30.derivativeName || \"\");\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(car_r30.year);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"\", i0.ɵɵpipeBind1(19, 21, car_r30.mileage), \" miles\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", car_r30.fuelTypeName);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\"\\u00A3\", i0.ɵɵpipeBind2(24, 23, car_r30.price, \"1.0-0\"), \"\");\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(28, _c1, car_r30.id))(\"queryParamsHandling\", \"preserve\");\n  }\n}\nfunction SearchComponent_div_268_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 84)(1, \"div\", 85)(2, \"h3\");\n    i0.ɵɵtext(3, \"No cars found\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"p\");\n    i0.ɵɵtext(5, \"Try adjusting your filters to see more results.\");\n    i0.ɵɵelementEnd()()();\n  }\n}\nfunction SearchComponent_div_271_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r34 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 86)(1, \"button\", 87);\n    i0.ɵɵpipe(2, \"async\");\n    i0.ɵɵpipe(3, \"async\");\n    i0.ɵɵlistener(\"click\", function SearchComponent_div_271_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r34);\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.prevPage());\n    });\n    i0.ɵɵtext(4, \"Previous\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"span\", 88);\n    i0.ɵɵtext(6);\n    i0.ɵɵpipe(7, \"async\");\n    i0.ɵɵpipe(8, \"async\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"button\", 87);\n    i0.ɵɵpipe(10, \"async\");\n    i0.ɵɵpipe(11, \"async\");\n    i0.ɵɵpipe(12, \"async\");\n    i0.ɵɵlistener(\"click\", function SearchComponent_div_271_Template_button_click_9_listener() {\n      i0.ɵɵrestoreView(_r34);\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.nextPage());\n    });\n    i0.ɵɵtext(13, \"Next\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    let tmp_1_0;\n    let tmp_3_0;\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"disabled\", ((tmp_1_0 = i0.ɵɵpipeBind1(2, 4, ctx_r3.page$)) !== null && tmp_1_0 !== undefined ? tmp_1_0 : 1) === 1 || i0.ɵɵpipeBind1(3, 6, ctx_r3.loading$));\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate2(\"Page \", i0.ɵɵpipeBind1(7, 8, ctx_r3.page$), \" of \", i0.ɵɵpipeBind1(8, 10, ctx_r3.totalPages$), \"\");\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"disabled\", ((tmp_3_0 = i0.ɵɵpipeBind1(10, 12, ctx_r3.page$)) !== null && tmp_3_0 !== undefined ? tmp_3_0 : 1) === ((tmp_3_0 = i0.ɵɵpipeBind1(11, 14, ctx_r3.totalPages$)) !== null && tmp_3_0 !== undefined ? tmp_3_0 : 1) || i0.ɵɵpipeBind1(12, 16, ctx_r3.loading$));\n  }\n}\nfunction SearchComponent_mat_progress_bar_273_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"mat-progress-bar\", 89);\n  }\n}\nexport let SearchComponent = /*#__PURE__*/(() => {\n  class SearchComponent {\n    api = inject(ListingsApiService);\n    route = inject(ActivatedRoute);\n    router = inject(Router);\n    seedingFromUrl = false;\n    hasSeeded = false;\n    // Sorting options (used in template)\n    sortOptions = [{\n      label: 'Price: Low to High',\n      value: 'price-asc'\n    }, {\n      label: 'Price: High to Low',\n      value: 'price-desc'\n    }, {\n      label: 'Year: Newest',\n      value: 'year-desc'\n    }, {\n      label: 'Year: Oldest',\n      value: 'year-asc'\n    }];\n    // Filter subjects\n    selectedMakeCodes$ = new BehaviorSubject([]);\n    selectedModelCodes$ = new BehaviorSubject([]);\n    selectedTransmissionCodes$ = new BehaviorSubject([]);\n    selectedBodyTypeCodes$ = new BehaviorSubject([]);\n    selectedFuelTypeCodes$ = new BehaviorSubject([]);\n    selectedSeats$ = new BehaviorSubject([]);\n    selectedDoors$ = new BehaviorSubject([]);\n    // Range filters\n    priceMin$ = new BehaviorSubject(undefined);\n    priceMax$ = new BehaviorSubject(undefined);\n    yearMin$ = new BehaviorSubject(undefined);\n    yearMax$ = new BehaviorSubject(undefined);\n    mileageMin$ = new BehaviorSubject(undefined);\n    mileageMax$ = new BehaviorSubject(undefined);\n    // Year dropdown options (1980..current)\n    yearStart = 1980;\n    yearEnd = new Date().getFullYear();\n    yearOptionsAsc = Array.from({\n      length: this.yearEnd - this.yearStart + 1\n    }, (_, i) => this.yearStart + i);\n    yearOptionsDesc = [...this.yearOptionsAsc].reverse();\n    // Sorting & pagination subjects\n    sort$ = new BehaviorSubject('price-asc');\n    page$ = new BehaviorSubject(1);\n    pageSize$ = new BehaviorSubject(12);\n    // Loading indicator\n    loading$ = new BehaviorSubject(true);\n    // UI state: grid/list view and mobile filters visibility\n    view$ = new BehaviorSubject('grid');\n    filtersVisible$ = new BehaviorSubject(false);\n    mobileSortOpen$ = new BehaviorSubject(false);\n    // Reference data derived from ListingService facet labels (no Catalog dependency)\n    // Facet params and counts (base stream used throughout)\n    facetParams$ = combineLatest([this.selectedMakeCodes$, this.selectedModelCodes$, this.selectedTransmissionCodes$, this.selectedBodyTypeCodes$, this.selectedFuelTypeCodes$, this.selectedSeats$, this.selectedDoors$, this.priceMin$, this.priceMax$, this.yearMin$, this.yearMax$, this.mileageMin$, this.mileageMax$]).pipe(debounceTime(100), map(([makeCodes, modelCodes, transmissionTypeCodes, bodyTypeCodes, fuelTypeCodes, seats, doors, priceMin, priceMax, yearMin, yearMax, mileageMin, mileageMax]) => ({\n      makeCodes,\n      modelCodes,\n      transmissionTypeCodes,\n      bodyTypeCodes,\n      fuelTypeCodes,\n      seats,\n      doors,\n      priceMin,\n      priceMax,\n      yearMin,\n      yearMax,\n      mileageMin,\n      mileageMax\n    })), distinctUntilChanged((a, b) => JSON.stringify(a) === JSON.stringify(b)), shareReplay(1));\n    mapFacetDto(dto) {\n      return {\n        makes: new Map(Object.entries(dto.makes).map(([k, v]) => [String(k), v])),\n        models: new Map(Object.entries(dto.models).map(([k, v]) => [String(k), v])),\n        transmissions: new Map(Object.entries(dto.transmissions).map(([k, v]) => [String(k), v])),\n        bodies: new Map(Object.entries(dto.bodies).map(([k, v]) => [String(k), v])),\n        fuels: new Map(Object.entries(dto.fuels).map(([k, v]) => [String(k), v])),\n        seats: new Map(Object.entries(dto.seats ?? {}).map(([k, v]) => [Number(k), v])),\n        doors: new Map(Object.entries(dto.doors ?? {}).map(([k, v]) => [Number(k), v])),\n        years: new Map(Object.entries(dto.years).map(([k, v]) => [Number(k), v])),\n        prices: new Map(Object.entries(dto.prices).map(([k, v]) => [Number(k), v])),\n        mileages: new Map(Object.entries(dto.mileages).map(([k, v]) => [Number(k), v])),\n        priceStep: dto.priceStep,\n        mileageStep: dto.mileageStep,\n        minMileage: dto.minMileage,\n        mileageExact: new Map(Object.entries(dto.mileageExact ?? {}).map(([k, v]) => [Number(k), v])),\n        // Labels\n        makeLabels: new Map(Object.entries(dto.makeLabels ?? {}).map(([k, v]) => [String(k), String(v)])),\n        modelLabels: new Map(Object.entries(dto.modelLabels ?? {}).map(([k, v]) => [String(k), String(v)])),\n        modelMakeCodes: new Map(Object.entries(dto.modelMakeCodes ?? {}).map(([k, v]) => [String(k), String(v)])),\n        transmissionLabels: new Map(Object.entries(dto.transmissionLabels ?? {}).map(([k, v]) => [String(k), String(v)])),\n        bodyLabels: new Map(Object.entries(dto.bodyLabels ?? {}).map(([k, v]) => [String(k), String(v)])),\n        fuelLabels: new Map(Object.entries(dto.fuelLabels ?? {}).map(([k, v]) => [String(k), String(v)]))\n      };\n    }\n    // Facet counts & labels from ListingService (single call shared)\n    facetCounts$ = this.facetParams$.pipe(switchMap(params => this.api.getFacetCounts(params)), map(dto => this.mapFacetDto(dto)), shareReplay(1));\n    // Build options arrays from label maps\n    makesAll$ = this.facetCounts$.pipe(map(fc => Array.from((fc.makeLabels ?? new Map()).entries()).map(([code, name]) => ({\n      code,\n      name\n    }))), shareReplay(1));\n    allTransmissions$ = this.facetCounts$.pipe(map(fc => Array.from((fc.transmissionLabels ?? new Map()).entries()).map(([code, name]) => ({\n      code,\n      name\n    }))), shareReplay(1));\n    allBodyTypes$ = this.facetCounts$.pipe(map(fc => Array.from((fc.bodyLabels ?? new Map()).entries()).map(([code, name]) => ({\n      code,\n      name\n    }))), shareReplay(1));\n    allFuelTypes$ = this.facetCounts$.pipe(map(fc => Array.from((fc.fuelLabels ?? new Map()).entries()).map(([code, name]) => ({\n      code,\n      name\n    }))), shareReplay(1));\n    modelsAll$ = this.facetCounts$.pipe(map(fc => {\n      const names = fc.modelLabels ?? new Map();\n      const parent = fc.modelMakeCodes ?? new Map();\n      return Array.from(names.entries()).map(([code, name]) => ({\n        code,\n        name,\n        makeCode: parent.get(code) ?? ''\n      }));\n    }), shareReplay(1));\n    // Models depend on selected make\n    models$ = combineLatest([this.modelsAll$, this.selectedMakeCodes$]).pipe(map(([all, codes]) => codes.length ? all.filter(m => codes.includes(m.makeCode)) : all), shareReplay(1));\n    // Variants filter removed\n    // Query params stream\n    query$ = combineLatest([this.selectedMakeCodes$, this.selectedModelCodes$, this.selectedTransmissionCodes$, this.selectedBodyTypeCodes$, this.selectedFuelTypeCodes$, this.selectedSeats$, this.selectedDoors$, this.priceMin$, this.priceMax$, this.yearMin$, this.yearMax$, this.mileageMin$, this.mileageMax$, this.sort$, this.page$, this.pageSize$]).pipe(debounceTime(100), map(([makeCodes, modelCodes, transmissionTypeCodes, bodyTypeCodes, fuelTypeCodes, seats, doors, priceMin, priceMax, yearMin, yearMax, mileageMin, mileageMax, sort, page, pageSize]) => ({\n      makeCodes,\n      modelCodes,\n      transmissionTypeCodes,\n      bodyTypeCodes,\n      fuelTypeCodes,\n      seats,\n      doors,\n      priceMin,\n      priceMax,\n      yearMin,\n      yearMax,\n      mileageMin,\n      mileageMax,\n      sort,\n      page,\n      pageSize\n    })), distinctUntilChanged((a, b) => JSON.stringify(a) === JSON.stringify(b)), shareReplay(1));\n    // Results stream\n    results$ = this.query$.pipe(tap(() => this.loading$.next(true)), switchMap(({\n      makeCodes,\n      modelCodes,\n      transmissionTypeCodes,\n      bodyTypeCodes,\n      fuelTypeCodes,\n      seats,\n      doors,\n      priceMin,\n      priceMax,\n      yearMin,\n      yearMax,\n      mileageMin,\n      mileageMax,\n      sort,\n      page,\n      pageSize\n    }) => {\n      const [sortBy, sortDirection] = this.mapSort(sort);\n      const params = {\n        makeCodes,\n        modelCodes,\n        transmissionTypeCodes,\n        bodyTypeCodes,\n        fuelTypeCodes,\n        seats,\n        doors,\n        priceMin,\n        priceMax,\n        yearMin,\n        yearMax,\n        mileageMin,\n        mileageMax,\n        page,\n        pageSize,\n        sortBy,\n        sortDirection\n      };\n      return this.api.searchListings(params).pipe(catchError(() => this.api.getListings({}).pipe(map(xs => ({\n        data: xs,\n        totalCount: xs.length,\n        totalPages: Math.max(1, Math.ceil(xs.length / pageSize)),\n        currentPage: page,\n        pageSize\n      })))));\n    }), tap(() => this.loading$.next(false)), shareReplay(1));\n    // Derived UI streams\n    listings$ = this.results$.pipe(map(r => r.data));\n    totalCount$ = this.results$.pipe(map(r => r.totalCount));\n    totalPages$ = this.results$.pipe(map(r => r.totalPages));\n    // Facet counts: server already computes counts ignoring each facet selection within a single response\n    // Filtered facet option streams (only show options with count > 0)\n    makes$ = combineLatest([this.makesAll$, this.facetCounts$]).pipe(map(([makes, counts]) => makes.filter(m => (counts.makes.get(m.code) ?? 0) > 0)), shareReplay(1));\n    // Show only options with count > 0 (but keep currently selected visible)\n    transmissions$ = combineLatest([this.allTransmissions$, this.facetCounts$]).pipe(map(([opts, counts]) => opts.filter(t => (counts.transmissions.get(t.code) ?? 0) > 0)), shareReplay(1));\n    bodyTypes$ = combineLatest([this.allBodyTypes$, this.facetCounts$]).pipe(map(([opts, counts]) => opts.filter(b => (counts.bodies.get(b.code) ?? 0) > 0)), shareReplay(1));\n    fuelTypes$ = combineLatest([this.allFuelTypes$, this.facetCounts$]).pipe(map(([opts, counts]) => opts.filter(f => (counts.fuels.get(f.code) ?? 0) > 0)), shareReplay(1));\n    // Seats and Doors counts already ignore their own selection in server response\n    seatsCounts$ = this.facetCounts$.pipe(map(x => x.seats));\n    doorsCounts$ = this.facetCounts$.pipe(map(x => x.doors));\n    // Options show only values with count > 0 (self-excluding counts already applied)\n    seats$ = this.seatsCounts$.pipe(map(m => {\n      const defaults = [2, 3, 4, 5, 6, 7, 8, 9];\n      const fromCounts = Array.from(m.keys());\n      return Array.from(new Set([...defaults, ...fromCounts])).sort((a, b) => a - b);\n    }), shareReplay(1));\n    doors$ = this.doorsCounts$.pipe(map(m => {\n      const defaults = [2, 3, 4, 5];\n      const fromCounts = Array.from(m.keys());\n      return Array.from(new Set([...defaults, ...fromCounts])).sort((a, b) => a - b);\n    }), shareReplay(1));\n    // Models already depend on selected make; apply counts filter too\n    filteredModels$ = combineLatest([this.models$, this.facetCounts$]).pipe(map(([models, counts]) => models.filter(m => (counts.models.get(m.code) ?? 0) > 0)), shareReplay(1));\n    // Facet collapse preferences and open states (open when any selection is active)\n    // Keep Make facet open on initial load\n    makePref$ = new BehaviorSubject(true);\n    modelPref$ = new BehaviorSubject(false);\n    transPref$ = new BehaviorSubject(false);\n    bodyPref$ = new BehaviorSubject(false);\n    fuelPref$ = new BehaviorSubject(false);\n    seatsPref$ = new BehaviorSubject(false);\n    doorsPref$ = new BehaviorSubject(false);\n    makeOpen$ = this.makePref$.asObservable();\n    modelOpen$ = this.modelPref$.asObservable();\n    transOpen$ = this.transPref$.asObservable();\n    bodyOpen$ = this.bodyPref$.asObservable();\n    fuelOpen$ = this.fuelPref$.asObservable();\n    seatsOpen$ = this.seatsPref$.asObservable();\n    doorsOpen$ = this.doorsPref$.asObservable();\n    toggleMakeFacet() {\n      this.makePref$.next(!this.makePref$.value);\n    }\n    toggleModelFacet() {\n      this.modelPref$.next(!this.modelPref$.value);\n    }\n    toggleTransmissionFacet() {\n      this.transPref$.next(!this.transPref$.value);\n    }\n    toggleBodyFacet() {\n      this.bodyPref$.next(!this.bodyPref$.value);\n    }\n    toggleFuelFacet() {\n      this.fuelPref$.next(!this.fuelPref$.value);\n    }\n    toggleSeatsFacet() {\n      this.seatsPref$.next(!this.seatsPref$.value);\n    }\n    toggleDoorsFacet() {\n      this.doorsPref$.next(!this.doorsPref$.value);\n    }\n    // Topbar controls\n    setView(v) {\n      this.view$.next(v);\n    }\n    toggleView() {\n      const v = this.view$.value;\n      this.view$.next(v === 'grid' ? 'list' : 'grid');\n    }\n    toggleFilters() {\n      this.filtersVisible$.next(!this.filtersVisible$.value);\n    }\n    toggleMobileSort() {\n      this.mobileSortOpen$.next(!this.mobileSortOpen$.value);\n    }\n    setSort(v) {\n      this.sort$.next(v);\n      this.mobileSortOpen$.next(false);\n    }\n    // Range facet collapse preferences and open states\n    pricePref$ = new BehaviorSubject(false);\n    yearPref$ = new BehaviorSubject(false);\n    mileagePref$ = new BehaviorSubject(false);\n    priceOpen$ = combineLatest([this.priceMin$, this.priceMax$, this.pricePref$]).pipe(map(([min, max, pref]) => min != null || max != null ? true : pref), shareReplay(1));\n    yearOpen$ = combineLatest([this.yearMin$, this.yearMax$, this.yearPref$]).pipe(map(([min, max, pref]) => min != null || max != null ? true : pref), shareReplay(1));\n    mileageOpen$ = combineLatest([this.mileageMin$, this.mileageMax$, this.mileagePref$]).pipe(map(([min, max, pref]) => min != null || max != null ? true : pref), shareReplay(1));\n    togglePriceFacet() {\n      this.pricePref$.next(!this.pricePref$.value);\n    }\n    toggleYearFacet() {\n      this.yearPref$.next(!this.yearPref$.value);\n    }\n    toggleMileageFacet() {\n      this.mileagePref$.next(!this.mileagePref$.value);\n    }\n    // Facet count maps for template usage\n    makeCounts$ = this.facetCounts$.pipe(map(x => x.makes));\n    modelCounts$ = this.facetCounts$.pipe(map(x => x.models));\n    transmissionCounts$ = this.facetCounts$.pipe(map(x => x.transmissions));\n    bodyCounts$ = this.facetCounts$.pipe(map(x => x.bodies));\n    fuelCounts$ = this.facetCounts$.pipe(map(x => x.fuels));\n    // Year counts and option lists derived from server\n    yearCounts$ = this.facetCounts$.pipe(map(x => x.years));\n    yearValues$ = this.yearCounts$.pipe(map(mapper => Array.from(mapper.keys()).sort((a, b) => b - a)), shareReplay(1));\n    fromYearOptions$ = combineLatest([this.yearValues$, this.yearMax$]).pipe(map(([vals, max]) => vals.filter(y => max == null || y <= max)), shareReplay(1));\n    toYearOptions$ = combineLatest([this.yearValues$, this.yearMin$]).pipe(map(([vals, min]) => vals.filter(y => min == null || y >= min)), shareReplay(1));\n    // Year prefix sums for dynamic range counts (ascending order)\n    yearPrefixSums$ = combineLatest([this.yearCounts$, this.yearCounts$.pipe(map(m => Array.from(m.keys()).sort((a, b) => a - b)))]).pipe(map(([counts, ascYears]) => {\n      const prefix = [];\n      const index = new Map();\n      let sum = 0;\n      ascYears.forEach((y, i) => {\n        index.set(y, i);\n        sum += counts.get(y) ?? 0;\n        prefix.push(sum);\n      });\n      return {\n        sorted: ascYears,\n        prefix,\n        index\n      };\n    }), shareReplay(1));\n    // From Year counts reflect [from .. currentMax] or >= from\n    fromYearCumulativeCounts$ = combineLatest([this.yearPrefixSums$, this.yearMax$]).pipe(map(([prep, maxYear]) => {\n      const res = new Map();\n      const j = maxYear != null ? prep.index.get(maxYear) ?? -1 : -1;\n      for (let i = 0; i < prep.sorted.length; i++) {\n        const y = prep.sorted[i];\n        if (j >= 0) {\n          if (i > j) {\n            res.set(y, 0);\n            continue;\n          }\n          const left = i > 0 ? prep.prefix[i - 1] : 0;\n          const right = prep.prefix[j];\n          res.set(y, right - left);\n        } else {\n          const left = i > 0 ? prep.prefix[i - 1] : 0;\n          const total = prep.prefix[prep.prefix.length - 1] ?? 0;\n          res.set(y, total - left);\n        }\n      }\n      return res;\n    }), shareReplay(1));\n    // To Year counts reflect [currentMin .. to] or <= to\n    toYearCumulativeCounts$ = combineLatest([this.yearPrefixSums$, this.yearMin$]).pipe(map(([prep, minYear]) => {\n      const res = new Map();\n      const iMin = minYear != null ? prep.index.get(minYear) ?? -1 : -1;\n      for (let i = 0; i < prep.sorted.length; i++) {\n        const y = prep.sorted[i];\n        if (iMin >= 0) {\n          if (i < iMin) {\n            res.set(y, 0);\n            continue;\n          }\n          const left = iMin > 0 ? prep.prefix[iMin - 1] : 0;\n          const right = prep.prefix[i];\n          res.set(y, right - left);\n        } else {\n          res.set(y, prep.prefix[i]);\n        }\n      }\n      return res;\n    }), shareReplay(1));\n    // Price counts and option lists derived from server buckets\n    priceCounts$ = this.facetCounts$.pipe(map(x => x.prices));\n    priceStep$ = this.facetCounts$.pipe(map(x => x.priceStep));\n    priceValues$ = this.priceCounts$.pipe(map(mapper => Array.from(mapper.keys()).sort((a, b) => a - b)), shareReplay(1));\n    // Precompute prefix sums to support dynamic range counts\n    pricePrefixSums$ = combineLatest([this.priceCounts$, this.priceValues$]).pipe(map(([counts, vals]) => {\n      const sorted = [...vals].sort((a, b) => a - b);\n      const prefix = [];\n      const index = new Map();\n      let sum = 0;\n      sorted.forEach((start, i) => {\n        index.set(start, i);\n        sum += counts.get(start) ?? 0;\n        prefix.push(sum);\n      });\n      return {\n        sorted,\n        prefix,\n        index\n      };\n    }), shareReplay(1));\n    // For \"From\" price, show counts within [from .. currentMax] if max set, else >= from\n    fromPriceCumulativeCounts$ = combineLatest([this.pricePrefixSums$, this.priceMax$, this.priceStep$]).pipe(map(([prep, maxEnd, step]) => {\n      const res = new Map();\n      const maxStart = maxEnd != null && step ? maxEnd - (step - 1) : undefined;\n      const j = maxStart != null ? prep.index.get(maxStart) ?? -1 : -1;\n      for (let i = 0; i < prep.sorted.length; i++) {\n        const start = prep.sorted[i];\n        if (j >= 0) {\n          if (i > j) {\n            res.set(start, 0);\n            continue;\n          }\n          const left = i > 0 ? prep.prefix[i - 1] : 0;\n          const right = prep.prefix[j];\n          res.set(start, right - left);\n        } else {\n          const left = i > 0 ? prep.prefix[i - 1] : 0;\n          const total = prep.prefix[prep.prefix.length - 1] ?? 0;\n          res.set(start, total - left);\n        }\n      }\n      return res;\n    }), shareReplay(1));\n    fromPriceOptions$ = combineLatest([this.priceValues$, this.priceMax$, this.priceStep$]).pipe(map(([vals, max, step]) => vals.filter(p => max == null || p <= max)), shareReplay(1));\n    toPriceOptions$ = combineLatest([this.priceValues$, this.priceMin$, this.priceStep$]).pipe(map(([vals, min, step]) => vals.filter(p => {\n      if (min == null) return true;\n      const end = p + (step ?? 0) - 1;\n      return end >= min;\n    })), shareReplay(1));\n    // For \"To\" price, show counts within [currentMin .. to] if min set, else <= to\n    toPriceCumulativeCounts$ = combineLatest([this.pricePrefixSums$, this.priceMin$]).pipe(map(([prep, minStart]) => {\n      const res = new Map();\n      const iMin = minStart != null ? prep.index.get(minStart) ?? -1 : -1;\n      for (let i = 0; i < prep.sorted.length; i++) {\n        const start = prep.sorted[i];\n        if (iMin >= 0) {\n          if (i < iMin) {\n            res.set(start, 0);\n            continue;\n          }\n          const left = iMin > 0 ? prep.prefix[iMin - 1] : 0;\n          const right = prep.prefix[i];\n          res.set(start, right - left);\n        } else {\n          res.set(start, prep.prefix[i]);\n        }\n      }\n      return res;\n    }), shareReplay(1));\n    // Mileage counts and option lists derived from server buckets\n    mileageCounts$ = this.facetCounts$.pipe(map(x => x.mileages));\n    mileageStep$ = this.facetCounts$.pipe(map(x => x.mileageStep));\n    minMileage$ = this.facetCounts$.pipe(map(x => x.minMileage));\n    mileageExact$ = this.facetCounts$.pipe(map(x => x.mileageExact ?? new Map()));\n    mileageValues$ = this.mileageCounts$.pipe(map(mapper => Array.from(mapper.keys()).sort((a, b) => a - b)), shareReplay(1));\n    // Overall max mileage cap (max exact or bucket end)\n    maxMileageOverall$ = combineLatest([this.mileageExact$, this.mileageValues$, this.mileageStep$]).pipe(map(([exact, bucketStarts, step]) => {\n      const maxExact = Array.from(exact.keys()).reduce((mx, k) => Math.max(mx, k), 0);\n      const lastStart = bucketStarts.length ? bucketStarts[bucketStarts.length - 1] : 0;\n      const maxBucketEnd = (step ?? 0) > 0 ? lastStart + (step ?? 0) - 1 : lastStart;\n      return Math.max(maxExact, maxBucketEnd);\n    }), shareReplay(1));\n    // Mileage option sequence includes seeds, step increments, and exact mileages present\n    mileageOptionValues$ = combineLatest([this.mileageValues$, this.mileageStep$, this.mileageExact$]).pipe(map(([bucketStarts, step, exact]) => {\n      const inc = step || 5000;\n      const maxStart = bucketStarts.length ? bucketStarts[bucketStarts.length - 1] : 0;\n      const maxEnd = maxStart + inc - 1;\n      const vals = [];\n      const seed = [0, 100, 500, 1000, 2000, 3000, 4000];\n      for (const v of seed) {\n        if (v <= maxEnd) vals.push(v);\n      }\n      let cur = inc; // start at step (e.g., 5000)\n      while (cur <= maxEnd) {\n        vals.push(cur);\n        cur += inc;\n      }\n      for (const v of Array.from(exact.keys())) {\n        if (v <= maxEnd) vals.push(v);\n      }\n      return Array.from(new Set(vals)).sort((a, b) => a - b);\n    }), shareReplay(1));\n    fromMileageOptions$ = combineLatest([this.mileageOptionValues$, this.mileageMax$]).pipe(map(([vals, max]) => vals.filter(m => max == null || m <= max)), shareReplay(1));\n    // To mileage thousand-step options: start at lowest available thousand (>= minMileage), exclude 0\n    toMileageOptions$ = combineLatest([this.minMileage$, this.maxMileageOverall$]).pipe(map(([minAvail, overallMax]) => {\n      const start = Math.max(1000, Math.ceil((minAvail ?? 1) / 1000) * 1000);\n      const cap = Math.max(start, Math.ceil((overallMax ?? 0) / 1000) * 1000);\n      const arr = [];\n      for (let v = start; v <= cap; v += 1000) arr.push(v);\n      return arr;\n    }), shareReplay(1));\n    // Derive selected 'To' bucket start from max using fixed step\n    mileageMaxStart$ = combineLatest([this.mileageMax$, this.mileageStep$]).pipe(map(([end, step]) => end == null || !step ? undefined : end - (step - 1)), shareReplay(1));\n    // Mileage prefix sums for dynamic range counts\n    mileagePrefixSums$ = combineLatest([this.mileageCounts$, this.mileageValues$]).pipe(map(([counts, vals]) => {\n      const sorted = [...vals].sort((a, b) => a - b);\n      const prefix = [];\n      const index = new Map();\n      let sum = 0;\n      sorted.forEach((start, i) => {\n        index.set(start, i);\n        sum += counts.get(start) ?? 0;\n        prefix.push(sum);\n      });\n      return {\n        sorted,\n        prefix,\n        index\n      };\n    }), shareReplay(1));\n    // From Mileage counts reflect [from .. currentMax] or >= from (using bucket start for max)\n    fromMileageCumulativeCounts$ = combineLatest([this.mileagePrefixSums$, this.mileageMaxStart$]).pipe(map(([prep, maxStart]) => {\n      const res = new Map();\n      const j = maxStart != null ? prep.index.get(maxStart) ?? -1 : -1;\n      for (let i = 0; i < prep.sorted.length; i++) {\n        const m = prep.sorted[i];\n        if (j >= 0) {\n          if (i > j) {\n            res.set(m, 0);\n            continue;\n          }\n          const left = i > 0 ? prep.prefix[i - 1] : 0;\n          const right = prep.prefix[j];\n          res.set(m, right - left);\n        } else {\n          const left = i > 0 ? prep.prefix[i - 1] : 0;\n          const total = prep.prefix[prep.prefix.length - 1] ?? 0;\n          res.set(m, total - left);\n        }\n      }\n      return res;\n    }), shareReplay(1));\n    // To Mileage counts reflect [currentMin .. to] or <= to\n    toMileageCumulativeCounts$ = combineLatest([this.mileagePrefixSums$, this.mileageMin$]).pipe(map(([prep, minStart]) => {\n      const res = new Map();\n      const iMin = minStart != null ? prep.index.get(minStart) ?? -1 : -1;\n      for (let i = 0; i < prep.sorted.length; i++) {\n        const m = prep.sorted[i];\n        if (iMin >= 0) {\n          if (i < iMin) {\n            res.set(m, 0);\n            continue;\n          }\n          const left = iMin > 0 ? prep.prefix[iMin - 1] : 0;\n          const right = prep.prefix[i];\n          res.set(m, right - left);\n        } else {\n          res.set(m, prep.prefix[i]);\n        }\n      }\n      return res;\n    }), shareReplay(1));\n    // Exact mileage prefix sums for thousand-rounded counts\n    mileageExactPrefix$ = this.mileageExact$.pipe(map(exact => {\n      const sorted = Array.from(exact.keys()).sort((a, b) => a - b);\n      const prefix = [];\n      let sum = 0;\n      for (const m of sorted) {\n        sum += exact.get(m) ?? 0;\n        prefix.push(sum);\n      }\n      return {\n        sorted,\n        prefix\n      };\n    }), shareReplay(1));\n    // Total cars ignoring mileage (for 0 option on From)\n    totalMileageAll$ = this.mileageExactPrefix$.pipe(map(prep => prep.prefix[prep.prefix.length - 1] ?? 0), shareReplay(1));\n    // Display counts for From-mileage options using thousand-rounded end; override 0 => total\n    fromMileageDisplayCounts$ = combineLatest([this.mileageExactPrefix$, this.mileageMax$, this.fromMileageOptions$, this.totalMileageAll$]).pipe(map(([prep, maxSel, opts, totalAll]) => {\n      const res = new Map();\n      const sumUpTo = x => {\n        const arr = prep.sorted;\n        let lo = 0,\n          hi = arr.length - 1,\n          ans = -1;\n        while (lo <= hi) {\n          const mid = lo + hi >> 1;\n          if (arr[mid] <= x) {\n            ans = mid;\n            lo = mid + 1;\n          } else {\n            hi = mid - 1;\n          }\n        }\n        return ans >= 0 ? prep.prefix[ans] : 0;\n      };\n      const endRounded = maxSel != null ? Math.ceil(maxSel / 1000) * 1000 : prep.sorted[prep.sorted.length - 1] ?? 0;\n      for (const v of opts) {\n        const fromVal = v || 0;\n        const c = Math.max(0, sumUpTo(endRounded) - sumUpTo(fromVal - 1));\n        res.set(v, c);\n      }\n      // 0 shows all cars ignoring To\n      res.set(0, totalAll);\n      return res;\n    }), shareReplay(1));\n    toMileageDisplayCounts$ = combineLatest([this.mileageExactPrefix$, this.mileageMin$, this.toMileageOptions$]).pipe(map(([prep, min, opts]) => {\n      const res = new Map();\n      const sumUpTo = x => {\n        const arr = prep.sorted;\n        let lo = 0,\n          hi = arr.length - 1,\n          ans = -1;\n        while (lo <= hi) {\n          const mid = lo + hi >> 1;\n          if (arr[mid] <= x) {\n            ans = mid;\n            lo = mid + 1;\n          } else {\n            hi = mid - 1;\n          }\n        }\n        return ans >= 0 ? prep.prefix[ans] : 0;\n      };\n      const minLess = min != null ? sumUpTo(min - 1) : 0;\n      for (const v of opts) {\n        const endRounded = Math.ceil((v || 0) / 1000) * 1000;\n        const c = Math.max(0, sumUpTo(endRounded) - minLess);\n        res.set(v, c);\n      }\n      return res;\n    }), shareReplay(1));\n    // From mileage options filtered to those with non-zero counts (0 included)\n    fromMileageOptionsFiltered$ = combineLatest([this.fromMileageOptions$, this.fromMileageDisplayCounts$]).pipe(map(([opts, counts]) => opts.filter(o => (counts.get(o) ?? 0) > 0)), shareReplay(1));\n    toMileageOptionsFiltered$ = combineLatest([this.toMileageOptions$, this.toMileageDisplayCounts$, this.minMileage$]).pipe(map(([opts, counts, min]) => {\n      const minVal = min ?? 0;\n      return opts.filter(o => o > 0 && o >= minVal && (counts.get(o) ?? 0) > 0);\n    }), shareReplay(1));\n    // Show stepped From options where counts decrease (plus 0)\n    fromMileageOptionsStepped$ = combineLatest([this.fromMileageOptionsFiltered$, this.fromMileageDisplayCounts$]).pipe(map(([opts, counts]) => {\n      const sorted = [...opts].sort((a, b) => a - b);\n      const result = [];\n      let last = undefined;\n      for (const v of sorted) {\n        const c = counts.get(v) ?? 0;\n        if (result.length === 0) {\n          result.push(v);\n          last = c;\n          continue;\n        }\n        if (last == null || c < last) {\n          result.push(v);\n          last = c;\n        }\n      }\n      return result;\n    }), shareReplay(1));\n    fromMileageOptionsVisible$ = this.fromMileageOptionsStepped$;\n    toMileageOptionsStepped$ = combineLatest([this.toMileageOptionsFiltered$, this.toMileageDisplayCounts$]).pipe(map(([opts, counts]) => {\n      const sorted = [...opts].sort((a, b) => a - b);\n      const result = [];\n      let last = -1;\n      for (const v of sorted) {\n        const c = counts.get(v) ?? 0;\n        if (result.length === 0) {\n          result.push(v);\n          last = c;\n          continue;\n        }\n        if (c > last) {\n          result.push(v);\n          last = c;\n        }\n      }\n      return result;\n    }), shareReplay(1));\n    // Active filter chips (kind + id/value for removal)\n    activeFilterChips$ = combineLatest([this.selectedMakeCodes$, this.makes$.pipe(startWith([])), this.selectedModelCodes$, this.filteredModels$.pipe(startWith([])), this.selectedTransmissionCodes$, this.transmissions$.pipe(startWith([])), this.selectedBodyTypeCodes$, this.bodyTypes$.pipe(startWith([])), this.selectedFuelTypeCodes$, this.fuelTypes$.pipe(startWith([])), this.selectedSeats$, this.seats$.pipe(startWith([])), this.selectedDoors$, this.doors$.pipe(startWith([]))]).pipe(map(([mkCodes, makes, mdCodes, models, trCodes, transmissions, btCodes, bodies, fuCodes, fuels, seatVals, seatOpts, doorVals, doorOpts]) => {\n      const chips = [];\n      const pushNameChips = (codes, list, kind) => {\n        codes.forEach(code => {\n          const nm = list.find(x => x.code === code)?.name;\n          if (nm) chips.push({\n            kind,\n            code,\n            label: nm\n          });\n        });\n      };\n      pushNameChips(mkCodes, makes, 'make');\n      pushNameChips(mdCodes, models, 'model');\n      pushNameChips(trCodes, transmissions, 'transmission');\n      pushNameChips(btCodes, bodies, 'body');\n      pushNameChips(fuCodes, fuels, 'fuel');\n      seatVals.forEach(v => chips.push({\n        kind: 'seats',\n        value: v,\n        label: `${v} seats`\n      }));\n      doorVals.forEach(v => chips.push({\n        kind: 'doors',\n        value: v,\n        label: `${v} doors`\n      }));\n      return chips;\n    }), shareReplay(1));\n    // Count of active filters for quick display (include ranges)\n    activeFilterCount$ = combineLatest([this.activeFilterChips$, this.priceMin$, this.priceMax$, this.yearMin$, this.yearMax$, this.mileageMin$, this.mileageMax$]).pipe(map(([chips, pmin, pmax, ymin, ymax, mmin, mmax]) => {\n      let extra = 0;\n      if (pmin != null || pmax != null) extra++;\n      if (ymin != null || ymax != null) extra++;\n      if (mmin != null || mmax != null) extra++;\n      return (chips?.length ?? 0) + extra;\n    }));\n    constructor() {\n      // Enforce grid view on small screens and hide list option\n      if (typeof window !== 'undefined' && window.matchMedia) {\n        const mq = window.matchMedia('(max-width: 767px)');\n        const enforce = () => {\n          if (mq.matches && this.view$.value !== 'grid') this.view$.next('grid');\n        };\n        enforce();\n        mq.addEventListener?.('change', enforce);\n      }\n      // Seed from URL using names (comma-separated)\n      combineLatest([this.route.queryParamMap, this.makesAll$.pipe(startWith([])), this.modelsAll$.pipe(startWith([])), this.allTransmissions$.pipe(startWith([])), this.allBodyTypes$.pipe(startWith([])), this.allFuelTypes$.pipe(startWith([]))]).subscribe(([q, makes, models, transmissions, bodies, fuels]) => {\n        // Only treat the first emission as initial seeding\n        const isFirstSeed = !this.hasSeeded;\n        if (isFirstSeed) this.seedingFromUrl = true;\n        const namesToCodes = (param, list) => {\n          if (!param) return [];\n          const normalizeQuery = s => s.trim().toLowerCase().replace(/[+\\-]+/g, ' ').replace(/\\s+/g, ' ');\n          const normalizeLabel = s => (s || '').trim().toLowerCase().replace(/[\\s_\\-]+/g, ' ').replace(/\\s+/g, ' ');\n          const wanted = param.split(',').map(normalizeQuery).filter(Boolean);\n          return list.filter(x => wanted.includes(normalizeLabel(x.name ?? ''))).map(x => x.code);\n        };\n        const codesFrom = key => q.getAll(key).filter(Boolean);\n        const numbersFromCsv = param => {\n          if (!param) return [];\n          return param.split(',').map(s => Number(s.trim())).filter(n => !Number.isNaN(n));\n        };\n        // Prefer code-based params when present; fallback to names\n        const mkCodes = codesFrom('makeCodes');\n        const mdCodes = codesFrom('modelCodes');\n        const trCodes = codesFrom('transmissionTypeCodes');\n        const btCodes = codesFrom('bodyTypeCodes');\n        const fuCodes = codesFrom('fuelTypeCodes');\n        this.selectedMakeCodes$.next(mkCodes.length ? mkCodes : namesToCodes(q.get('make'), makes));\n        this.selectedModelCodes$.next(mdCodes.length ? mdCodes : namesToCodes(q.get('model'), models));\n        this.selectedTransmissionCodes$.next(trCodes.length ? trCodes : namesToCodes(q.get('trans'), transmissions));\n        this.selectedBodyTypeCodes$.next(btCodes.length ? btCodes : namesToCodes(q.get('body'), bodies));\n        this.selectedFuelTypeCodes$.next(fuCodes.length ? fuCodes : namesToCodes(q.get('fuel'), fuels));\n        // Numeric facets and ranges\n        this.selectedSeats$.next(numbersFromCsv(q.get('seats')));\n        this.selectedDoors$.next(numbersFromCsv(q.get('doors')));\n        const toNum = v => v == null || v === '' ? undefined : Number(v);\n        this.priceMin$.next(toNum(q.get('pmin')) ?? toNum(q.get('priceMin')));\n        this.priceMax$.next(toNum(q.get('pmax')) ?? toNum(q.get('priceMax')));\n        this.yearMin$.next(toNum(q.get('ymin')));\n        this.yearMax$.next(toNum(q.get('ymax')));\n        this.mileageMin$.next(toNum(q.get('mmin')) ?? toNum(q.get('mileageMin')));\n        this.mileageMax$.next(toNum(q.get('mmax')) ?? toNum(q.get('mileageMax')));\n        const s = q.get('sort');\n        if (s) this.sort$.next(s);\n        const v = (q.get('view') || '').toLowerCase();\n        if (v === 'list' || v === 'grid') this.view$.next(v);\n        const p = q.get('page');\n        this.page$.next(p ? Number(p) : 1);\n        const fv = (q.get('filters') || '').toLowerCase();\n        if (fv && (fv === '1' || fv === 'true' || fv === 'open')) this.filtersVisible$.next(true);\n        // On initial load, open facets that have selections\n        if ((this.selectedMakeCodes$.value?.length ?? 0) > 0) this.makePref$.next(true);\n        if ((this.selectedModelCodes$.value?.length ?? 0) > 0) this.modelPref$.next(true);\n        if ((this.selectedTransmissionCodes$.value?.length ?? 0) > 0) this.transPref$.next(true);\n        if ((this.selectedBodyTypeCodes$.value?.length ?? 0) > 0) this.bodyPref$.next(true);\n        if ((this.selectedFuelTypeCodes$.value?.length ?? 0) > 0) this.fuelPref$.next(true);\n        if ((this.selectedSeats$.value?.length ?? 0) > 0) this.seatsPref$.next(true);\n        if ((this.selectedDoors$.value?.length ?? 0) > 0) this.doorsPref$.next(true);\n        if (isFirstSeed) {\n          this.hasSeeded = true;\n          this.seedingFromUrl = false;\n        }\n      });\n      // Persist to URL on changes\n      combineLatest([this.selectedMakeCodes$, this.makesAll$.pipe(startWith([])), this.selectedModelCodes$, this.modelsAll$.pipe(startWith([])), this.selectedTransmissionCodes$, this.allTransmissions$.pipe(startWith([])), this.selectedBodyTypeCodes$, this.allBodyTypes$.pipe(startWith([])), this.selectedFuelTypeCodes$, this.allFuelTypes$.pipe(startWith([])), this.selectedSeats$, this.selectedDoors$, this.priceMin$, this.priceMax$, this.yearMin$, this.yearMax$, this.mileageMin$, this.mileageMax$, this.sort$, this.page$, this.filtersVisible$]).pipe(debounceTime(50)).subscribe(([mkIds, makes, mdIds, models, trIds, transmissions, btIds, bodies, fuIds, fuels, seats, doors, pmin, pmax, ymin, ymax, mmin, mmax, sort, page, filtersVisible]) => {\n        const slug = s => (s || '').toLowerCase().trim().replace(/[\\s_]+/g, '+').replace(/[+]+/g, '+');\n        const namesFor = (codes, list) => codes.map(code => list.find(x => x.code === code)?.name).filter(nm => typeof nm === 'string' && nm.length > 0).map(slug);\n        const current = this.route.snapshot.queryParamMap;\n        const useFallback = this.seedingFromUrl && !this.hasSeeded;\n        // Build params without default sort/page; append them at the end if changed\n        const qp = {\n          make: (() => {\n            const v = namesFor(mkIds, makes).join(',');\n            return v || (useFallback ? current.get('make') : undefined);\n          })(),\n          model: (() => {\n            const v = namesFor(mdIds, models).join(',');\n            return v || (useFallback ? current.get('model') : undefined);\n          })(),\n          trans: (() => {\n            const v = namesFor(trIds, transmissions).join(',');\n            return v || (useFallback ? current.get('trans') : undefined);\n          })(),\n          body: (() => {\n            const v = namesFor(btIds, bodies).join(',');\n            return v || (useFallback ? current.get('body') : undefined);\n          })(),\n          fuel: (() => {\n            const v = namesFor(fuIds, fuels).join(',');\n            return v || (useFallback ? current.get('fuel') : undefined);\n          })(),\n          seats: seats?.length ? seats.join(',') : useFallback ? current.get('seats') ?? undefined : undefined,\n          doors: doors?.length ? doors.join(',') : useFallback ? current.get('doors') ?? undefined : undefined,\n          pmin: pmin != null ? pmin : useFallback ? current.get('pmin') ?? undefined : undefined,\n          pmax: pmax != null ? pmax : useFallback ? current.get('pmax') ?? undefined : undefined,\n          ymin: ymin != null ? ymin : useFallback ? current.get('ymin') ?? undefined : undefined,\n          ymax: ymax != null ? ymax : useFallback ? current.get('ymax') ?? undefined : undefined,\n          mmin: mmin != null ? mmin : useFallback ? current.get('mmin') ?? undefined : undefined,\n          mmax: mmax != null ? mmax : useFallback ? current.get('mmax') ?? undefined : undefined\n        };\n        // Remove any code-based params so URL stays name-based\n        qp.makeCodes = null;\n        qp.modelCodes = null;\n        qp.transmissionTypeCodes = null;\n        qp.bodyTypeCodes = null;\n        qp.fuelTypeCodes = null;\n        qp.priceMin = null;\n        qp.priceMax = null;\n        qp.mileageMin = null;\n        qp.mileageMax = null;\n        // Persist view (only when not default)\n        if ((this.view$.value ?? 'grid') === 'list') qp.view = 'list';else qp.view = null;\n        // Persist filters panel visibility (best UX: only include when open)\n        qp.filters = filtersVisible ? '1' : null;\n        // Append non-default sort/page to the end\n        if (sort !== 'price-asc') qp.sort = sort;\n        if (page !== 1) qp.page = page;\n        this.router.navigate([], {\n          queryParams: qp\n        });\n      });\n      // Reset to first page when filters or sort change\n      combineLatest([this.selectedMakeCodes$, this.selectedModelCodes$, this.selectedTransmissionCodes$, this.selectedBodyTypeCodes$, this.selectedFuelTypeCodes$, this.selectedSeats$, this.selectedDoors$, this.priceMin$, this.priceMax$, this.yearMin$, this.yearMax$, this.mileageMin$, this.mileageMax$, this.sort$]).pipe(debounceTime(50)).subscribe(() => this.page$.next(1));\n      // Reset dependent selections to avoid stale combos\n      this.selectedMakeCodes$.pipe(distinctUntilChanged()).subscribe(() => {\n        if (this.seedingFromUrl) return;\n        this.selectedModelCodes$.next([]);\n      });\n      // Variant dependency removed\n    }\n    mapSort(v) {\n      switch (v) {\n        case 'price-asc':\n          return ['price', 'asc'];\n        case 'price-desc':\n          return ['price', 'desc'];\n        case 'year-asc':\n          return ['year', 'asc'];\n        case 'year-desc':\n          return ['year', 'desc'];\n        default:\n          return ['price', 'asc'];\n      }\n    }\n    prevPage() {\n      combineLatest([this.page$, this.totalPages$]).pipe(take(1)).subscribe(([p]) => {\n        if (p > 1) this.page$.next(p - 1);\n      });\n    }\n    nextPage() {\n      combineLatest([this.page$, this.totalPages$]).pipe(take(1)).subscribe(([p, t]) => {\n        if (p < t) this.page$.next(p + 1);\n      });\n    }\n    // Toggle helpers for multiselect checkboxes\n    toggle(ids$, id) {\n      const curr = ids$.value;\n      ids$.next(curr.includes(id) ? curr.filter(x => x !== id) : [...curr, id]);\n    }\n    clear(ids$) {\n      ids$.next([]);\n    }\n    removeFrom(ids$, idOrCode) {\n      ids$.next(ids$.value.filter(x => x !== idOrCode));\n    }\n    clearAll() {\n      this.selectedMakeCodes$.next([]);\n      this.selectedModelCodes$.next([]);\n      this.selectedTransmissionCodes$.next([]);\n      this.selectedBodyTypeCodes$.next([]);\n      this.selectedFuelTypeCodes$.next([]);\n      this.selectedSeats$.next([]);\n      this.selectedDoors$.next([]);\n      this.priceMin$.next(undefined);\n      this.priceMax$.next(undefined);\n      this.yearMin$.next(undefined);\n      this.yearMax$.next(undefined);\n      this.mileageMin$.next(undefined);\n      this.mileageMax$.next(undefined);\n    }\n    toggleMake(code) {\n      this.toggle(this.selectedMakeCodes$, code);\n    }\n    toggleModel(code) {\n      this.toggle(this.selectedModelCodes$, code);\n    }\n    toggleTransmission(code) {\n      this.toggle(this.selectedTransmissionCodes$, code);\n    }\n    toggleBodyType(code) {\n      this.toggle(this.selectedBodyTypeCodes$, code);\n    }\n    toggleFuelType(code) {\n      this.toggle(this.selectedFuelTypeCodes$, code);\n    }\n    toggleSeat(v) {\n      this.toggle(this.selectedSeats$, v);\n    }\n    toggleDoor(v) {\n      this.toggle(this.selectedDoors$, v);\n    }\n    // Remove a single active filter via chip close\n    removeChip(c) {\n      switch (c.kind) {\n        case 'make':\n          if (c.code != null) this.removeFrom(this.selectedMakeCodes$, c.code);\n          break;\n        case 'model':\n          if (c.code != null) this.removeFrom(this.selectedModelCodes$, c.code);\n          break;\n        case 'transmission':\n          if (c.code != null) this.removeFrom(this.selectedTransmissionCodes$, c.code);\n          break;\n        case 'body':\n          if (c.code != null) this.removeFrom(this.selectedBodyTypeCodes$, c.code);\n          break;\n        case 'fuel':\n          if (c.code != null) this.removeFrom(this.selectedFuelTypeCodes$, c.code);\n          break;\n        case 'seats':\n          if (c.value != null) this.removeFrom(this.selectedSeats$, c.value);\n          break;\n        case 'doors':\n          if (c.value != null) this.removeFrom(this.selectedDoors$, c.value);\n          break;\n      }\n    }\n    // Simple illustrative monthly price (placeholder UI affordance)\n    monthly(price) {\n      return Math.round((price || 0) / 60);\n    }\n    // Year range validation: ensure From <= To by adjusting the opposite side\n    onYearMinChange(v) {\n      const val = v === '' ? undefined : Number(v);\n      const currentMax = this.yearMax$.value;\n      this.yearMin$.next(val);\n      if (val != null && currentMax != null && val > currentMax) {\n        this.yearMax$.next(val);\n      }\n    }\n    onYearMaxChange(v) {\n      const val = v === '' ? undefined : Number(v);\n      const currentMin = this.yearMin$.value;\n      this.yearMax$.next(val);\n      if (val != null && currentMin != null && val < currentMin) {\n        this.yearMin$.next(val);\n      }\n    }\n    // Price range via bucketed selects: ensure From <= To\n    onPriceMinChange(v) {\n      const val = v === '' ? undefined : Number(v);\n      const currentMax = this.priceMax$.value;\n      this.priceMin$.next(val);\n      if (val != null && currentMax != null && val > currentMax) {\n        this.priceMax$.next(val);\n      }\n    }\n    onPriceMaxChange(v) {\n      const bucketStart = v === '' ? undefined : Number(v);\n      // Convert bucket start to bucket end using step\n      if (bucketStart == null) {\n        this.priceMax$.next(undefined);\n        return;\n      }\n      combineLatest([this.priceStep$]).pipe(take(1)).subscribe(([step]) => {\n        const end = bucketStart + (step ?? 0) - 1;\n        const currentMin = this.priceMin$.value;\n        this.priceMax$.next(end);\n        if (currentMin != null && end < currentMin) {\n          this.priceMin$.next(bucketStart);\n        }\n      });\n    }\n    // Mileage range via bucketed selects: ensure From <= To\n    onMileageMinChange(v) {\n      const val = v === '' ? undefined : Number(v);\n      const currentMax = this.mileageMax$.value;\n      this.mileageMin$.next(val);\n      if (val != null && currentMax != null && val > currentMax) {\n        this.mileageMax$.next(val);\n      }\n    }\n    onMileageMaxChange(v) {\n      const val = v === '' ? undefined : Number(v);\n      if (val == null) {\n        this.mileageMax$.next(undefined);\n        return;\n      }\n      const currentMin = this.mileageMin$.value;\n      this.mileageMax$.next(val);\n      if (currentMin != null && val < currentMin) {\n        this.mileageMin$.next(val);\n      }\n    }\n    // Keyboard shortcuts: g = grid, l = list, f = filters, esc = close panels\n    handleKeydown(ev) {\n      const tag = ev.target?.tagName?.toLowerCase();\n      if (tag === 'input' || tag === 'select' || tag === 'textarea' || ev.isComposing) return;\n      const key = ev.key?.toLowerCase();\n      if (key === 'g') {\n        this.setView('grid');\n      } else if (key === 'l') {\n        // Respect small screens: list view will be forced to grid by media enforcement\n        this.setView('list');\n      } else if (key === 'f') {\n        this.toggleFilters();\n      } else if (key === 'escape') {\n        if (this.mobileSortOpen$.value) this.mobileSortOpen$.next(false);\n        if (this.filtersVisible$.value) this.filtersVisible$.next(false);\n      }\n    }\n    // Simple per-card image carousel state (similar to Featured Listings)\n    indices = new Map();\n    currentIndex(l) {\n      return this.indices.get(l.id) ?? 0;\n    }\n    next(l) {\n      const imgs = l.images ?? [];\n      if (!imgs.length) return;\n      const i = (this.currentIndex(l) + 1) % imgs.length;\n      this.indices.set(l.id, i);\n    }\n    prev(l) {\n      const imgs = l.images ?? [];\n      if (!imgs.length) return;\n      const i = (this.currentIndex(l) - 1 + imgs.length) % imgs.length;\n      this.indices.set(l.id, i);\n    }\n    static ɵfac = function SearchComponent_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || SearchComponent)();\n    };\n    static ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: SearchComponent,\n      selectors: [[\"app-search\"]],\n      hostBindings: function SearchComponent_HostBindings(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵlistener(\"keydown\", function SearchComponent_keydown_HostBindingHandler($event) {\n            return ctx.handleKeydown($event);\n          }, false, i0.ɵɵresolveDocument);\n        }\n      },\n      standalone: true,\n      features: [i0.ɵɵStandaloneFeature],\n      decls: 275,\n      vars: 268,\n      consts: [[\"noImage\", \"\"], [1, \"find-car-container\"], [1, \"topbar\"], [\"aria-controls\", \"filters-panel\", 1, \"filters-toggle\", 3, \"click\"], [1, \"right-controls\"], [1, \"sort-wrap\"], [\"for\", \"sort-select\", 1, \"sort-label\", \"desktop-only\"], [\"id\", \"sort-select\", 1, \"sort-select\", \"desktop-only\", 3, \"ngModelChange\", \"ngModel\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"aria-controls\", \"mobile-sort-panel\", 1, \"mobile-sort-btn\", 3, \"click\"], [\"class\", \"sort-panel\", \"id\", \"mobile-sort-panel\", 4, \"ngIf\"], [1, \"view-wrap\"], [1, \"view-btn\", \"view-btn--single\", 3, \"click\"], [4, \"ngIf\"], [1, \"main-content\"], [\"id\", \"filters-panel\", 1, \"filter-sidebar\"], [1, \"filters-panel-inner\"], [1, \"filter-header\"], [1, \"filter-title\"], [\"href\", \"#\", 1, \"clear-all\", 3, \"click\"], [\"class\", \"active-filters active-filters--filters\", 4, \"ngIf\"], [1, \"filter-content\"], [1, \"filter-section\"], [\"role\", \"button\", \"tabindex\", \"0\", 1, \"section-header\", 3, \"click\", \"keydown.enter\", \"keydown.space\"], [1, \"section-title-container\"], [1, \"section-title\"], [1, \"chevron\"], [1, \"section-content\"], [1, \"options-container\"], [\"class\", \"filter-option\", 4, \"ngFor\", \"ngForOf\"], [1, \"range-row\"], [1, \"range-input\"], [1, \"range-mini-label\"], [1, \"range-select\", 3, \"ngModelChange\", \"ngModel\"], [\"value\", \"\"], [\"role\", \"button\", 1, \"section-header\", 3, \"click\"], [1, \"mobile-filter-footer\"], [1, \"see-results-btn\", 3, \"click\"], [1, \"car-results\"], [1, \"results-header\"], [\"class\", \"active-filters active-filters--results\", 4, \"ngIf\"], [1, \"car-grid\"], [\"class\", \"car-card\", 3, \"list\", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"no-results\", 4, \"ngIf\"], [\"class\", \"pagination\", 4, \"ngIf\"], [\"mode\", \"indeterminate\", 4, \"ngIf\"], [3, \"value\"], [\"id\", \"mobile-sort-panel\", 1, \"sort-panel\"], [\"class\", \"sort-item\", 3, \"active\", \"click\", 4, \"ngFor\", \"ngForOf\"], [1, \"sort-item\", 3, \"click\"], [1, \"active-filters\", \"active-filters--filters\"], [\"class\", \"filter-chip\", 4, \"ngFor\", \"ngForOf\"], [1, \"filter-chip\"], [1, \"chip-label\"], [\"title\", \"Remove\", 1, \"chip-close\", 3, \"click\"], [1, \"filter-option\"], [1, \"option-label\"], [\"type\", \"checkbox\", 1, \"filter-checkbox\", 3, \"change\", \"checked\"], [1, \"custom-checkbox\"], [\"width\", \"12\", \"height\", \"12\", \"viewBox\", \"0 0 24 24\", \"fill\", \"none\", 1, \"check-icon\"], [\"d\", \"M20 6L9 17L4 12\", \"stroke\", \"currentColor\", \"stroke-width\", \"3\", \"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\"], [1, \"option-text\"], [1, \"count\"], [1, \"active-filters\", \"active-filters--results\"], [1, \"car-card\"], [\"title\", \"View details\", 1, \"card-media\", 3, \"routerLink\", \"queryParamsHandling\"], [4, \"ngIf\", \"ngIfElse\"], [1, \"price-tag\"], [1, \"card-body\"], [1, \"title\"], [1, \"subtitle\"], [1, \"chips\", \"chips--inline\"], [1, \"chip\"], [\"class\", \"chip\", 4, \"ngIf\"], [1, \"price-row\"], [1, \"price\"], [1, \"actions\"], [1, \"btn\", \"btn-primary\", 3, \"routerLink\", \"queryParamsHandling\"], [\"alt\", \"car image\", 3, \"src\"], [\"class\", \"card-nav card-nav--left\", \"aria-label\", \"Previous image\", 3, \"click\", 4, \"ngIf\"], [\"class\", \"card-nav card-nav--right\", \"aria-label\", \"Next image\", 3, \"click\", 4, \"ngIf\"], [\"aria-label\", \"Previous image\", 1, \"card-nav\", \"card-nav--left\", 3, \"click\"], [\"aria-label\", \"Next image\", 1, \"card-nav\", \"card-nav--right\", 3, \"click\"], [1, \"media-placeholder\"], [1, \"no-results\"], [1, \"no-results-content\"], [1, \"pagination\"], [1, \"page-btn\", 3, \"click\", \"disabled\"], [1, \"page-info\"], [\"mode\", \"indeterminate\"]],\n      template: function SearchComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 1)(1, \"div\", 2)(2, \"button\", 3);\n          i0.ɵɵpipe(3, \"async\");\n          i0.ɵɵlistener(\"click\", function SearchComponent_Template_button_click_2_listener() {\n            return ctx.toggleFilters();\n          });\n          i0.ɵɵelementStart(4, \"mat-icon\");\n          i0.ɵɵtext(5, \"tune\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(6, \"span\");\n          i0.ɵɵtext(7, \"Filters\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(8, \"div\", 4)(9, \"div\", 5)(10, \"label\", 6);\n          i0.ɵɵtext(11, \"Sort\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(12, \"select\", 7);\n          i0.ɵɵpipe(13, \"async\");\n          i0.ɵɵlistener(\"ngModelChange\", function SearchComponent_Template_select_ngModelChange_12_listener($event) {\n            return ctx.sort$.next($event);\n          });\n          i0.ɵɵtemplate(14, SearchComponent_option_14_Template, 2, 2, \"option\", 8);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(15, \"button\", 9);\n          i0.ɵɵpipe(16, \"async\");\n          i0.ɵɵlistener(\"click\", function SearchComponent_Template_button_click_15_listener() {\n            return ctx.toggleMobileSort();\n          });\n          i0.ɵɵelementStart(17, \"span\");\n          i0.ɵɵtext(18, \"Sort\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(19, \"mat-icon\");\n          i0.ɵɵtext(20, \"expand_more\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵtemplate(21, SearchComponent_div_21_Template, 2, 1, \"div\", 10);\n          i0.ɵɵpipe(22, \"async\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(23, \"div\", 11)(24, \"button\", 12);\n          i0.ɵɵpipe(25, \"async\");\n          i0.ɵɵpipe(26, \"async\");\n          i0.ɵɵlistener(\"click\", function SearchComponent_Template_button_click_24_listener() {\n            return ctx.toggleView();\n          });\n          i0.ɵɵtemplate(27, SearchComponent_mat_icon_27_Template, 2, 0, \"mat-icon\", 13);\n          i0.ɵɵpipe(28, \"async\");\n          i0.ɵɵtemplate(29, SearchComponent_mat_icon_29_Template, 2, 0, \"mat-icon\", 13);\n          i0.ɵɵpipe(30, \"async\");\n          i0.ɵɵelementEnd()()()();\n          i0.ɵɵelementStart(31, \"div\", 14);\n          i0.ɵɵpipe(32, \"async\");\n          i0.ɵɵelementStart(33, \"aside\", 15);\n          i0.ɵɵpipe(34, \"async\");\n          i0.ɵɵelementStart(35, \"div\", 16)(36, \"div\", 17)(37, \"h3\", 18);\n          i0.ɵɵtext(38, \"Filters\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(39, \"a\", 19);\n          i0.ɵɵlistener(\"click\", function SearchComponent_Template_a_click_39_listener($event) {\n            $event.preventDefault();\n            return ctx.clearAll();\n          });\n          i0.ɵɵtext(40, \"Clear all\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵtemplate(41, SearchComponent_div_41_Template, 3, 3, \"div\", 20);\n          i0.ɵɵpipe(42, \"async\");\n          i0.ɵɵelementStart(43, \"div\", 21)(44, \"div\", 22)(45, \"div\", 23);\n          i0.ɵɵpipe(46, \"async\");\n          i0.ɵɵlistener(\"click\", function SearchComponent_Template_div_click_45_listener() {\n            return ctx.toggleMakeFacet();\n          })(\"keydown.enter\", function SearchComponent_Template_div_keydown_enter_45_listener() {\n            return ctx.toggleMakeFacet();\n          })(\"keydown.space\", function SearchComponent_Template_div_keydown_space_45_listener($event) {\n            $event.preventDefault();\n            return ctx.toggleMakeFacet();\n          });\n          i0.ɵɵelementStart(47, \"div\", 24)(48, \"h4\", 25);\n          i0.ɵɵtext(49, \"Make\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(50, \"span\", 26);\n          i0.ɵɵtemplate(51, SearchComponent_mat_icon_51_Template, 2, 0, \"mat-icon\", 13);\n          i0.ɵɵpipe(52, \"async\");\n          i0.ɵɵtemplate(53, SearchComponent_mat_icon_53_Template, 2, 0, \"mat-icon\", 13);\n          i0.ɵɵpipe(54, \"async\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(55, \"div\", 27);\n          i0.ɵɵpipe(56, \"async\");\n          i0.ɵɵelementStart(57, \"div\", 28);\n          i0.ɵɵtemplate(58, SearchComponent_div_58_Template, 12, 7, \"div\", 29);\n          i0.ɵɵpipe(59, \"async\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(60, \"div\", 22)(61, \"div\", 23);\n          i0.ɵɵpipe(62, \"async\");\n          i0.ɵɵlistener(\"click\", function SearchComponent_Template_div_click_61_listener() {\n            return ctx.toggleModelFacet();\n          })(\"keydown.enter\", function SearchComponent_Template_div_keydown_enter_61_listener() {\n            return ctx.toggleModelFacet();\n          })(\"keydown.space\", function SearchComponent_Template_div_keydown_space_61_listener($event) {\n            $event.preventDefault();\n            return ctx.toggleModelFacet();\n          });\n          i0.ɵɵelementStart(63, \"div\", 24)(64, \"h4\", 25);\n          i0.ɵɵtext(65, \"Model\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(66, \"span\", 26);\n          i0.ɵɵtemplate(67, SearchComponent_mat_icon_67_Template, 2, 0, \"mat-icon\", 13);\n          i0.ɵɵpipe(68, \"async\");\n          i0.ɵɵtemplate(69, SearchComponent_mat_icon_69_Template, 2, 0, \"mat-icon\", 13);\n          i0.ɵɵpipe(70, \"async\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(71, \"div\", 27);\n          i0.ɵɵpipe(72, \"async\");\n          i0.ɵɵelementStart(73, \"div\", 28);\n          i0.ɵɵtemplate(74, SearchComponent_div_74_Template, 12, 7, \"div\", 29);\n          i0.ɵɵpipe(75, \"async\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(76, \"div\", 22)(77, \"div\", 23);\n          i0.ɵɵpipe(78, \"async\");\n          i0.ɵɵlistener(\"click\", function SearchComponent_Template_div_click_77_listener() {\n            return ctx.togglePriceFacet();\n          })(\"keydown.enter\", function SearchComponent_Template_div_keydown_enter_77_listener() {\n            return ctx.togglePriceFacet();\n          })(\"keydown.space\", function SearchComponent_Template_div_keydown_space_77_listener($event) {\n            $event.preventDefault();\n            return ctx.togglePriceFacet();\n          });\n          i0.ɵɵelementStart(79, \"div\", 24)(80, \"h4\", 25);\n          i0.ɵɵtext(81, \"Price\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(82, \"span\", 26);\n          i0.ɵɵtemplate(83, SearchComponent_mat_icon_83_Template, 2, 0, \"mat-icon\", 13);\n          i0.ɵɵpipe(84, \"async\");\n          i0.ɵɵtemplate(85, SearchComponent_mat_icon_85_Template, 2, 0, \"mat-icon\", 13);\n          i0.ɵɵpipe(86, \"async\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(87, \"div\", 27);\n          i0.ɵɵpipe(88, \"async\");\n          i0.ɵɵelementStart(89, \"div\", 30)(90, \"div\", 31)(91, \"label\", 32);\n          i0.ɵɵtext(92, \"From\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(93, \"select\", 33);\n          i0.ɵɵpipe(94, \"async\");\n          i0.ɵɵlistener(\"ngModelChange\", function SearchComponent_Template_select_ngModelChange_93_listener($event) {\n            return ctx.onPriceMinChange($event);\n          });\n          i0.ɵɵelementStart(95, \"option\", 34);\n          i0.ɵɵtext(96, \"Any\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(97, SearchComponent_option_97_Template, 4, 8, \"option\", 8);\n          i0.ɵɵpipe(98, \"async\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(99, \"div\", 31)(100, \"label\", 32);\n          i0.ɵɵtext(101, \"To\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(102, \"select\", 33);\n          i0.ɵɵpipe(103, \"async\");\n          i0.ɵɵpipe(104, \"async\");\n          i0.ɵɵpipe(105, \"async\");\n          i0.ɵɵlistener(\"ngModelChange\", function SearchComponent_Template_select_ngModelChange_102_listener($event) {\n            return ctx.onPriceMaxChange($event);\n          });\n          i0.ɵɵelementStart(106, \"option\", 34);\n          i0.ɵɵtext(107, \"Any\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(108, SearchComponent_option_108_Template, 4, 8, \"option\", 8);\n          i0.ɵɵpipe(109, \"async\");\n          i0.ɵɵelementEnd()()()()();\n          i0.ɵɵelementStart(110, \"div\", 22)(111, \"div\", 23);\n          i0.ɵɵpipe(112, \"async\");\n          i0.ɵɵlistener(\"click\", function SearchComponent_Template_div_click_111_listener() {\n            return ctx.toggleYearFacet();\n          })(\"keydown.enter\", function SearchComponent_Template_div_keydown_enter_111_listener() {\n            return ctx.toggleYearFacet();\n          })(\"keydown.space\", function SearchComponent_Template_div_keydown_space_111_listener($event) {\n            $event.preventDefault();\n            return ctx.toggleYearFacet();\n          });\n          i0.ɵɵelementStart(113, \"div\", 24)(114, \"h4\", 25);\n          i0.ɵɵtext(115, \"Year\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(116, \"span\", 26);\n          i0.ɵɵtemplate(117, SearchComponent_mat_icon_117_Template, 2, 0, \"mat-icon\", 13);\n          i0.ɵɵpipe(118, \"async\");\n          i0.ɵɵtemplate(119, SearchComponent_mat_icon_119_Template, 2, 0, \"mat-icon\", 13);\n          i0.ɵɵpipe(120, \"async\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(121, \"div\", 27);\n          i0.ɵɵpipe(122, \"async\");\n          i0.ɵɵelementStart(123, \"div\", 30)(124, \"div\", 31)(125, \"label\", 32);\n          i0.ɵɵtext(126, \"From\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(127, \"select\", 33);\n          i0.ɵɵpipe(128, \"async\");\n          i0.ɵɵlistener(\"ngModelChange\", function SearchComponent_Template_select_ngModelChange_127_listener($event) {\n            return ctx.onYearMinChange($event);\n          });\n          i0.ɵɵelementStart(129, \"option\", 34);\n          i0.ɵɵtext(130, \"Any\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(131, SearchComponent_option_131_Template, 3, 5, \"option\", 8);\n          i0.ɵɵpipe(132, \"async\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(133, \"div\", 31)(134, \"label\", 32);\n          i0.ɵɵtext(135, \"To\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(136, \"select\", 33);\n          i0.ɵɵpipe(137, \"async\");\n          i0.ɵɵlistener(\"ngModelChange\", function SearchComponent_Template_select_ngModelChange_136_listener($event) {\n            return ctx.onYearMaxChange($event);\n          });\n          i0.ɵɵelementStart(138, \"option\", 34);\n          i0.ɵɵtext(139, \"Any\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(140, SearchComponent_option_140_Template, 3, 5, \"option\", 8);\n          i0.ɵɵpipe(141, \"async\");\n          i0.ɵɵelementEnd()()()()();\n          i0.ɵɵelementStart(142, \"div\", 22)(143, \"div\", 23);\n          i0.ɵɵpipe(144, \"async\");\n          i0.ɵɵlistener(\"click\", function SearchComponent_Template_div_click_143_listener() {\n            return ctx.toggleMileageFacet();\n          })(\"keydown.enter\", function SearchComponent_Template_div_keydown_enter_143_listener() {\n            return ctx.toggleMileageFacet();\n          })(\"keydown.space\", function SearchComponent_Template_div_keydown_space_143_listener($event) {\n            $event.preventDefault();\n            return ctx.toggleMileageFacet();\n          });\n          i0.ɵɵelementStart(145, \"div\", 24)(146, \"h4\", 25);\n          i0.ɵɵtext(147, \"Mileage\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(148, \"span\", 26);\n          i0.ɵɵtemplate(149, SearchComponent_mat_icon_149_Template, 2, 0, \"mat-icon\", 13);\n          i0.ɵɵpipe(150, \"async\");\n          i0.ɵɵtemplate(151, SearchComponent_mat_icon_151_Template, 2, 0, \"mat-icon\", 13);\n          i0.ɵɵpipe(152, \"async\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(153, \"div\", 27);\n          i0.ɵɵpipe(154, \"async\");\n          i0.ɵɵelementStart(155, \"div\", 30)(156, \"div\", 31)(157, \"label\", 32);\n          i0.ɵɵtext(158, \"From\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(159, \"select\", 33);\n          i0.ɵɵpipe(160, \"async\");\n          i0.ɵɵlistener(\"ngModelChange\", function SearchComponent_Template_select_ngModelChange_159_listener($event) {\n            return ctx.onMileageMinChange($event);\n          });\n          i0.ɵɵelementStart(161, \"option\", 34);\n          i0.ɵɵtext(162, \"Any\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(163, SearchComponent_option_163_Template, 4, 8, \"option\", 8);\n          i0.ɵɵpipe(164, \"async\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(165, \"div\", 31)(166, \"label\", 32);\n          i0.ɵɵtext(167, \"To\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(168, \"select\", 33);\n          i0.ɵɵpipe(169, \"async\");\n          i0.ɵɵlistener(\"ngModelChange\", function SearchComponent_Template_select_ngModelChange_168_listener($event) {\n            return ctx.onMileageMaxChange($event);\n          });\n          i0.ɵɵelementStart(170, \"option\", 34);\n          i0.ɵɵtext(171, \"Any\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(172, SearchComponent_option_172_Template, 4, 8, \"option\", 8);\n          i0.ɵɵpipe(173, \"async\");\n          i0.ɵɵelementEnd()()()()();\n          i0.ɵɵelementStart(174, \"div\", 22)(175, \"div\", 23);\n          i0.ɵɵpipe(176, \"async\");\n          i0.ɵɵlistener(\"click\", function SearchComponent_Template_div_click_175_listener() {\n            return ctx.toggleTransmissionFacet();\n          })(\"keydown.enter\", function SearchComponent_Template_div_keydown_enter_175_listener() {\n            return ctx.toggleTransmissionFacet();\n          })(\"keydown.space\", function SearchComponent_Template_div_keydown_space_175_listener($event) {\n            $event.preventDefault();\n            return ctx.toggleTransmissionFacet();\n          });\n          i0.ɵɵelementStart(177, \"div\", 24)(178, \"h4\", 25);\n          i0.ɵɵtext(179, \"Gearbox\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(180, \"span\", 26);\n          i0.ɵɵtemplate(181, SearchComponent_mat_icon_181_Template, 2, 0, \"mat-icon\", 13);\n          i0.ɵɵpipe(182, \"async\");\n          i0.ɵɵtemplate(183, SearchComponent_mat_icon_183_Template, 2, 0, \"mat-icon\", 13);\n          i0.ɵɵpipe(184, \"async\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(185, \"div\", 27);\n          i0.ɵɵpipe(186, \"async\");\n          i0.ɵɵelementStart(187, \"div\", 28);\n          i0.ɵɵtemplate(188, SearchComponent_div_188_Template, 12, 7, \"div\", 29);\n          i0.ɵɵpipe(189, \"async\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(190, \"div\", 22)(191, \"div\", 23);\n          i0.ɵɵpipe(192, \"async\");\n          i0.ɵɵlistener(\"click\", function SearchComponent_Template_div_click_191_listener() {\n            return ctx.toggleBodyFacet();\n          })(\"keydown.enter\", function SearchComponent_Template_div_keydown_enter_191_listener() {\n            return ctx.toggleBodyFacet();\n          })(\"keydown.space\", function SearchComponent_Template_div_keydown_space_191_listener($event) {\n            $event.preventDefault();\n            return ctx.toggleBodyFacet();\n          });\n          i0.ɵɵelementStart(193, \"div\", 24)(194, \"h4\", 25);\n          i0.ɵɵtext(195, \"Body type\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(196, \"span\", 26);\n          i0.ɵɵtemplate(197, SearchComponent_mat_icon_197_Template, 2, 0, \"mat-icon\", 13);\n          i0.ɵɵpipe(198, \"async\");\n          i0.ɵɵtemplate(199, SearchComponent_mat_icon_199_Template, 2, 0, \"mat-icon\", 13);\n          i0.ɵɵpipe(200, \"async\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(201, \"div\", 27);\n          i0.ɵɵpipe(202, \"async\");\n          i0.ɵɵelementStart(203, \"div\", 28);\n          i0.ɵɵtemplate(204, SearchComponent_div_204_Template, 12, 7, \"div\", 29);\n          i0.ɵɵpipe(205, \"async\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(206, \"div\", 22)(207, \"div\", 23);\n          i0.ɵɵpipe(208, \"async\");\n          i0.ɵɵlistener(\"click\", function SearchComponent_Template_div_click_207_listener() {\n            return ctx.toggleFuelFacet();\n          })(\"keydown.enter\", function SearchComponent_Template_div_keydown_enter_207_listener() {\n            return ctx.toggleFuelFacet();\n          })(\"keydown.space\", function SearchComponent_Template_div_keydown_space_207_listener($event) {\n            $event.preventDefault();\n            return ctx.toggleFuelFacet();\n          });\n          i0.ɵɵelementStart(209, \"div\", 24)(210, \"h4\", 25);\n          i0.ɵɵtext(211, \"Fuel type\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(212, \"span\", 26);\n          i0.ɵɵtemplate(213, SearchComponent_mat_icon_213_Template, 2, 0, \"mat-icon\", 13);\n          i0.ɵɵpipe(214, \"async\");\n          i0.ɵɵtemplate(215, SearchComponent_mat_icon_215_Template, 2, 0, \"mat-icon\", 13);\n          i0.ɵɵpipe(216, \"async\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(217, \"div\", 27);\n          i0.ɵɵpipe(218, \"async\");\n          i0.ɵɵelementStart(219, \"div\", 28);\n          i0.ɵɵtemplate(220, SearchComponent_div_220_Template, 12, 7, \"div\", 29);\n          i0.ɵɵpipe(221, \"async\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(222, \"div\", 22)(223, \"div\", 35);\n          i0.ɵɵpipe(224, \"async\");\n          i0.ɵɵlistener(\"click\", function SearchComponent_Template_div_click_223_listener() {\n            return ctx.toggleSeatsFacet();\n          });\n          i0.ɵɵelementStart(225, \"div\", 24)(226, \"h4\", 25);\n          i0.ɵɵtext(227, \"Seats\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(228, \"span\", 26);\n          i0.ɵɵtemplate(229, SearchComponent_mat_icon_229_Template, 2, 0, \"mat-icon\", 13);\n          i0.ɵɵpipe(230, \"async\");\n          i0.ɵɵtemplate(231, SearchComponent_mat_icon_231_Template, 2, 0, \"mat-icon\", 13);\n          i0.ɵɵpipe(232, \"async\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(233, \"div\", 27);\n          i0.ɵɵpipe(234, \"async\");\n          i0.ɵɵelementStart(235, \"div\", 28);\n          i0.ɵɵtemplate(236, SearchComponent_div_236_Template, 12, 7, \"div\", 29);\n          i0.ɵɵpipe(237, \"async\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(238, \"div\", 22)(239, \"div\", 35);\n          i0.ɵɵpipe(240, \"async\");\n          i0.ɵɵlistener(\"click\", function SearchComponent_Template_div_click_239_listener() {\n            return ctx.toggleDoorsFacet();\n          });\n          i0.ɵɵelementStart(241, \"div\", 24)(242, \"h4\", 25);\n          i0.ɵɵtext(243, \"Doors\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(244, \"span\", 26);\n          i0.ɵɵtemplate(245, SearchComponent_mat_icon_245_Template, 2, 0, \"mat-icon\", 13);\n          i0.ɵɵpipe(246, \"async\");\n          i0.ɵɵtemplate(247, SearchComponent_mat_icon_247_Template, 2, 0, \"mat-icon\", 13);\n          i0.ɵɵpipe(248, \"async\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(249, \"div\", 27);\n          i0.ɵɵpipe(250, \"async\");\n          i0.ɵɵelementStart(251, \"div\", 28);\n          i0.ɵɵtemplate(252, SearchComponent_div_252_Template, 12, 7, \"div\", 29);\n          i0.ɵɵpipe(253, \"async\");\n          i0.ɵɵelementEnd()()()();\n          i0.ɵɵelementStart(254, \"div\", 36)(255, \"button\", 37);\n          i0.ɵɵlistener(\"click\", function SearchComponent_Template_button_click_255_listener() {\n            return ctx.filtersVisible$.next(false);\n          });\n          i0.ɵɵtext(256);\n          i0.ɵɵpipe(257, \"async\");\n          i0.ɵɵelementEnd()()()();\n          i0.ɵɵelementStart(258, \"main\", 38)(259, \"div\", 39);\n          i0.ɵɵtext(260);\n          i0.ɵɵpipe(261, \"async\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(262, SearchComponent_div_262_Template, 3, 3, \"div\", 40);\n          i0.ɵɵpipe(263, \"async\");\n          i0.ɵɵelementStart(264, \"div\", 41);\n          i0.ɵɵpipe(265, \"async\");\n          i0.ɵɵtemplate(266, SearchComponent_div_266_Template, 28, 30, \"div\", 42);\n          i0.ɵɵpipe(267, \"async\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(268, SearchComponent_div_268_Template, 6, 0, \"div\", 43);\n          i0.ɵɵpipe(269, \"async\");\n          i0.ɵɵpipe(270, \"async\");\n          i0.ɵɵtemplate(271, SearchComponent_div_271_Template, 14, 18, \"div\", 44);\n          i0.ɵɵpipe(272, \"async\");\n          i0.ɵɵtemplate(273, SearchComponent_mat_progress_bar_273_Template, 1, 0, \"mat-progress-bar\", 45);\n          i0.ɵɵpipe(274, \"async\");\n          i0.ɵɵelementEnd()()();\n        }\n        if (rf & 2) {\n          let tmp_11_0;\n          let tmp_16_0;\n          let tmp_21_0;\n          let tmp_26_0;\n          let tmp_27_0;\n          let tmp_28_0;\n          let tmp_29_0;\n          let tmp_34_0;\n          let tmp_35_0;\n          let tmp_36_0;\n          let tmp_37_0;\n          let tmp_42_0;\n          let tmp_43_0;\n          let tmp_44_0;\n          let tmp_45_0;\n          let tmp_50_0;\n          let tmp_55_0;\n          let tmp_60_0;\n          let tmp_65_0;\n          let tmp_70_0;\n          let tmp_71_0;\n          let tmp_72_0;\n          let tmp_73_0;\n          let tmp_75_0;\n          let tmp_76_0;\n          let tmp_77_0;\n          i0.ɵɵadvance(2);\n          i0.ɵɵattribute(\"aria-expanded\", i0.ɵɵpipeBind1(3, 92, ctx.filtersVisible$) ? \"true\" : \"false\");\n          i0.ɵɵadvance(10);\n          i0.ɵɵproperty(\"ngModel\", i0.ɵɵpipeBind1(13, 94, ctx.sort$));\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngForOf\", ctx.sortOptions);\n          i0.ɵɵadvance();\n          i0.ɵɵattribute(\"aria-expanded\", i0.ɵɵpipeBind1(16, 96, ctx.mobileSortOpen$) ? \"true\" : \"false\");\n          i0.ɵɵadvance(6);\n          i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(22, 98, ctx.mobileSortOpen$));\n          i0.ɵɵadvance(3);\n          i0.ɵɵattribute(\"aria-label\", i0.ɵɵpipeBind1(25, 100, ctx.view$) === \"grid\" ? \"Switch to list view\" : \"Switch to grid view\")(\"aria-pressed\", i0.ɵɵpipeBind1(26, 102, ctx.view$) === \"list\" ? \"true\" : \"false\");\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(28, 104, ctx.view$) === \"grid\");\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(30, 106, ctx.view$) === \"list\");\n          i0.ɵɵadvance(2);\n          i0.ɵɵclassProp(\"mobile-filters-open\", i0.ɵɵpipeBind1(32, 108, ctx.filtersVisible$));\n          i0.ɵɵadvance(2);\n          i0.ɵɵclassProp(\"show-mobile\", i0.ɵɵpipeBind1(34, 110, ctx.filtersVisible$));\n          i0.ɵɵadvance(8);\n          i0.ɵɵproperty(\"ngIf\", (tmp_11_0 = i0.ɵɵpipeBind1(42, 112, ctx.activeFilterChips$)) == null ? null : tmp_11_0.length);\n          i0.ɵɵadvance(4);\n          i0.ɵɵattribute(\"aria-expanded\", i0.ɵɵpipeBind1(46, 114, ctx.makeOpen$) ? \"true\" : \"false\");\n          i0.ɵɵadvance(6);\n          i0.ɵɵproperty(\"ngIf\", !i0.ɵɵpipeBind1(52, 116, ctx.makeOpen$));\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(54, 118, ctx.makeOpen$));\n          i0.ɵɵadvance(2);\n          i0.ɵɵclassProp(\"expanded\", i0.ɵɵpipeBind1(56, 120, ctx.makeOpen$));\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"ngForOf\", (tmp_16_0 = i0.ɵɵpipeBind1(59, 122, ctx.makes$)) !== null && tmp_16_0 !== undefined ? tmp_16_0 : i0.ɵɵpureFunction0(254, _c0));\n          i0.ɵɵadvance(3);\n          i0.ɵɵattribute(\"aria-expanded\", i0.ɵɵpipeBind1(62, 124, ctx.modelOpen$) ? \"true\" : \"false\");\n          i0.ɵɵadvance(6);\n          i0.ɵɵproperty(\"ngIf\", !i0.ɵɵpipeBind1(68, 126, ctx.modelOpen$));\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(70, 128, ctx.modelOpen$));\n          i0.ɵɵadvance(2);\n          i0.ɵɵclassProp(\"expanded\", i0.ɵɵpipeBind1(72, 130, ctx.modelOpen$));\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"ngForOf\", (tmp_21_0 = i0.ɵɵpipeBind1(75, 132, ctx.filteredModels$)) !== null && tmp_21_0 !== undefined ? tmp_21_0 : i0.ɵɵpureFunction0(255, _c0));\n          i0.ɵɵadvance(3);\n          i0.ɵɵattribute(\"aria-expanded\", i0.ɵɵpipeBind1(78, 134, ctx.priceOpen$) ? \"true\" : \"false\");\n          i0.ɵɵadvance(6);\n          i0.ɵɵproperty(\"ngIf\", !i0.ɵɵpipeBind1(84, 136, ctx.priceOpen$));\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(86, 138, ctx.priceOpen$));\n          i0.ɵɵadvance(2);\n          i0.ɵɵclassProp(\"expanded\", i0.ɵɵpipeBind1(88, 140, ctx.priceOpen$));\n          i0.ɵɵadvance(6);\n          i0.ɵɵproperty(\"ngModel\", (tmp_26_0 = i0.ɵɵpipeBind1(94, 142, ctx.priceMin$)) !== null && tmp_26_0 !== undefined ? tmp_26_0 : \"\");\n          i0.ɵɵadvance(4);\n          i0.ɵɵproperty(\"ngForOf\", (tmp_27_0 = i0.ɵɵpipeBind1(98, 144, ctx.fromPriceOptions$)) !== null && tmp_27_0 !== undefined ? tmp_27_0 : i0.ɵɵpureFunction0(256, _c0));\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"ngModel\", i0.ɵɵpipeBind1(103, 146, ctx.priceMax$) != null ? i0.ɵɵpipeBind1(104, 148, ctx.priceMax$) - (((tmp_28_0 = i0.ɵɵpipeBind1(105, 150, ctx.priceStep$)) !== null && tmp_28_0 !== undefined ? tmp_28_0 : 0) - 1) : \"\");\n          i0.ɵɵadvance(6);\n          i0.ɵɵproperty(\"ngForOf\", (tmp_29_0 = i0.ɵɵpipeBind1(109, 152, ctx.toPriceOptions$)) !== null && tmp_29_0 !== undefined ? tmp_29_0 : i0.ɵɵpureFunction0(257, _c0));\n          i0.ɵɵadvance(3);\n          i0.ɵɵattribute(\"aria-expanded\", i0.ɵɵpipeBind1(112, 154, ctx.yearOpen$) ? \"true\" : \"false\");\n          i0.ɵɵadvance(6);\n          i0.ɵɵproperty(\"ngIf\", !i0.ɵɵpipeBind1(118, 156, ctx.yearOpen$));\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(120, 158, ctx.yearOpen$));\n          i0.ɵɵadvance(2);\n          i0.ɵɵclassProp(\"expanded\", i0.ɵɵpipeBind1(122, 160, ctx.yearOpen$));\n          i0.ɵɵadvance(6);\n          i0.ɵɵproperty(\"ngModel\", (tmp_34_0 = i0.ɵɵpipeBind1(128, 162, ctx.yearMin$)) !== null && tmp_34_0 !== undefined ? tmp_34_0 : \"\");\n          i0.ɵɵadvance(4);\n          i0.ɵɵproperty(\"ngForOf\", (tmp_35_0 = i0.ɵɵpipeBind1(132, 164, ctx.fromYearOptions$)) !== null && tmp_35_0 !== undefined ? tmp_35_0 : i0.ɵɵpureFunction0(258, _c0));\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"ngModel\", (tmp_36_0 = i0.ɵɵpipeBind1(137, 166, ctx.yearMax$)) !== null && tmp_36_0 !== undefined ? tmp_36_0 : \"\");\n          i0.ɵɵadvance(4);\n          i0.ɵɵproperty(\"ngForOf\", (tmp_37_0 = i0.ɵɵpipeBind1(141, 168, ctx.toYearOptions$)) !== null && tmp_37_0 !== undefined ? tmp_37_0 : i0.ɵɵpureFunction0(259, _c0));\n          i0.ɵɵadvance(3);\n          i0.ɵɵattribute(\"aria-expanded\", i0.ɵɵpipeBind1(144, 170, ctx.mileageOpen$) ? \"true\" : \"false\");\n          i0.ɵɵadvance(6);\n          i0.ɵɵproperty(\"ngIf\", !i0.ɵɵpipeBind1(150, 172, ctx.mileageOpen$));\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(152, 174, ctx.mileageOpen$));\n          i0.ɵɵadvance(2);\n          i0.ɵɵclassProp(\"expanded\", i0.ɵɵpipeBind1(154, 176, ctx.mileageOpen$));\n          i0.ɵɵadvance(6);\n          i0.ɵɵproperty(\"ngModel\", (tmp_42_0 = i0.ɵɵpipeBind1(160, 178, ctx.mileageMin$)) !== null && tmp_42_0 !== undefined ? tmp_42_0 : \"\");\n          i0.ɵɵadvance(4);\n          i0.ɵɵproperty(\"ngForOf\", (tmp_43_0 = i0.ɵɵpipeBind1(164, 180, ctx.fromMileageOptionsVisible$)) !== null && tmp_43_0 !== undefined ? tmp_43_0 : i0.ɵɵpureFunction0(260, _c0));\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"ngModel\", (tmp_44_0 = i0.ɵɵpipeBind1(169, 182, ctx.mileageMax$)) !== null && tmp_44_0 !== undefined ? tmp_44_0 : \"\");\n          i0.ɵɵadvance(4);\n          i0.ɵɵproperty(\"ngForOf\", (tmp_45_0 = i0.ɵɵpipeBind1(173, 184, ctx.toMileageOptionsStepped$)) !== null && tmp_45_0 !== undefined ? tmp_45_0 : i0.ɵɵpureFunction0(261, _c0));\n          i0.ɵɵadvance(3);\n          i0.ɵɵattribute(\"aria-expanded\", i0.ɵɵpipeBind1(176, 186, ctx.transOpen$) ? \"true\" : \"false\");\n          i0.ɵɵadvance(6);\n          i0.ɵɵproperty(\"ngIf\", !i0.ɵɵpipeBind1(182, 188, ctx.transOpen$));\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(184, 190, ctx.transOpen$));\n          i0.ɵɵadvance(2);\n          i0.ɵɵclassProp(\"expanded\", i0.ɵɵpipeBind1(186, 192, ctx.transOpen$));\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"ngForOf\", (tmp_50_0 = i0.ɵɵpipeBind1(189, 194, ctx.transmissions$)) !== null && tmp_50_0 !== undefined ? tmp_50_0 : i0.ɵɵpureFunction0(262, _c0));\n          i0.ɵɵadvance(3);\n          i0.ɵɵattribute(\"aria-expanded\", i0.ɵɵpipeBind1(192, 196, ctx.bodyOpen$) ? \"true\" : \"false\");\n          i0.ɵɵadvance(6);\n          i0.ɵɵproperty(\"ngIf\", !i0.ɵɵpipeBind1(198, 198, ctx.bodyOpen$));\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(200, 200, ctx.bodyOpen$));\n          i0.ɵɵadvance(2);\n          i0.ɵɵclassProp(\"expanded\", i0.ɵɵpipeBind1(202, 202, ctx.bodyOpen$));\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"ngForOf\", (tmp_55_0 = i0.ɵɵpipeBind1(205, 204, ctx.bodyTypes$)) !== null && tmp_55_0 !== undefined ? tmp_55_0 : i0.ɵɵpureFunction0(263, _c0));\n          i0.ɵɵadvance(3);\n          i0.ɵɵattribute(\"aria-expanded\", i0.ɵɵpipeBind1(208, 206, ctx.fuelOpen$) ? \"true\" : \"false\");\n          i0.ɵɵadvance(6);\n          i0.ɵɵproperty(\"ngIf\", !i0.ɵɵpipeBind1(214, 208, ctx.fuelOpen$));\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(216, 210, ctx.fuelOpen$));\n          i0.ɵɵadvance(2);\n          i0.ɵɵclassProp(\"expanded\", i0.ɵɵpipeBind1(218, 212, ctx.fuelOpen$));\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"ngForOf\", (tmp_60_0 = i0.ɵɵpipeBind1(221, 214, ctx.fuelTypes$)) !== null && tmp_60_0 !== undefined ? tmp_60_0 : i0.ɵɵpureFunction0(264, _c0));\n          i0.ɵɵadvance(3);\n          i0.ɵɵattribute(\"aria-expanded\", i0.ɵɵpipeBind1(224, 216, ctx.seatsOpen$) ? \"true\" : \"false\");\n          i0.ɵɵadvance(6);\n          i0.ɵɵproperty(\"ngIf\", !i0.ɵɵpipeBind1(230, 218, ctx.seatsOpen$));\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(232, 220, ctx.seatsOpen$));\n          i0.ɵɵadvance(2);\n          i0.ɵɵclassProp(\"expanded\", i0.ɵɵpipeBind1(234, 222, ctx.seatsOpen$));\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"ngForOf\", (tmp_65_0 = i0.ɵɵpipeBind1(237, 224, ctx.seats$)) !== null && tmp_65_0 !== undefined ? tmp_65_0 : i0.ɵɵpureFunction0(265, _c0));\n          i0.ɵɵadvance(3);\n          i0.ɵɵattribute(\"aria-expanded\", i0.ɵɵpipeBind1(240, 226, ctx.doorsOpen$) ? \"true\" : \"false\");\n          i0.ɵɵadvance(6);\n          i0.ɵɵproperty(\"ngIf\", !i0.ɵɵpipeBind1(246, 228, ctx.doorsOpen$));\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(248, 230, ctx.doorsOpen$));\n          i0.ɵɵadvance(2);\n          i0.ɵɵclassProp(\"expanded\", i0.ɵɵpipeBind1(250, 232, ctx.doorsOpen$));\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"ngForOf\", (tmp_70_0 = i0.ɵɵpipeBind1(253, 234, ctx.doors$)) !== null && tmp_70_0 !== undefined ? tmp_70_0 : i0.ɵɵpureFunction0(266, _c0));\n          i0.ɵɵadvance(4);\n          i0.ɵɵtextInterpolate1(\"See \", (tmp_71_0 = i0.ɵɵpipeBind1(257, 236, ctx.totalCount$)) !== null && tmp_71_0 !== undefined ? tmp_71_0 : 0, \" Results\");\n          i0.ɵɵadvance(4);\n          i0.ɵɵtextInterpolate1(\" We have found \", (tmp_72_0 = i0.ɵɵpipeBind1(261, 238, ctx.totalCount$)) !== null && tmp_72_0 !== undefined ? tmp_72_0 : 0, \" vehicles \");\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngIf\", (tmp_73_0 = i0.ɵɵpipeBind1(263, 240, ctx.activeFilterChips$)) == null ? null : tmp_73_0.length);\n          i0.ɵɵadvance(2);\n          i0.ɵɵclassProp(\"list-view\", i0.ɵɵpipeBind1(265, 242, ctx.view$) === \"list\");\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngForOf\", (tmp_75_0 = i0.ɵɵpipeBind1(267, 244, ctx.listings$)) !== null && tmp_75_0 !== undefined ? tmp_75_0 : i0.ɵɵpureFunction0(267, _c0));\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngIf\", !i0.ɵɵpipeBind1(269, 246, ctx.loading$) && ((tmp_76_0 = i0.ɵɵpipeBind1(270, 248, ctx.totalCount$)) !== null && tmp_76_0 !== undefined ? tmp_76_0 : 0) === 0);\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"ngIf\", ((tmp_77_0 = i0.ɵɵpipeBind1(272, 250, ctx.totalPages$)) !== null && tmp_77_0 !== undefined ? tmp_77_0 : 1) > 1);\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(274, 252, ctx.loading$));\n        }\n      },\n      dependencies: [CommonModule, i1.NgForOf, i1.NgIf, i1.AsyncPipe, i1.DecimalPipe, FormsModule, i2.NgSelectOption, i2.ɵNgSelectMultipleOption, i2.SelectControlValueAccessor, i2.NgControlStatus, i2.NgModel, MatFormFieldModule, MatSelectModule, MatIconModule, i3.MatIcon, MatCardModule, MatProgressBarModule, i4.MatProgressBar, RouterModule, i5.RouterLink],\n      styles: [\".find-car-container[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:16px}.header-section[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:16px;margin-bottom:16px}.results-title[_ngcontent-%COMP%]{margin:0;font-weight:600}.results-count[_ngcontent-%COMP%]{color:#666;margin:4px 0 0}.sort-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.main-content[_ngcontent-%COMP%]{display:grid;grid-template-columns:280px 1fr;gap:16px}.filter-sidebar[_ngcontent-%COMP%]{position:sticky;top:12px;align-self:start}.options-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;gap:8px}.filter-option[_ngcontent-%COMP%]{padding:6px 8px;border-radius:6px}.option-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.check-icon[_ngcontent-%COMP%]{display:none}@media (max-width: 992px){.car-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}.main-content[_ngcontent-%COMP%]{grid-template-columns:1fr}}.car-card[_ngcontent-%COMP%]{cursor:pointer}.thumb-wrap[_ngcontent-%COMP%]{position:relative}.thumb[_ngcontent-%COMP%]{width:100%;height:180px;object-fit:cover;border-radius:8px;border:1px solid #e0e0e0}.thumb.placeholder[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;background:#f3f4f6;border:1px dashed #ddd;height:180px;border-radius:8px}.price-badge[_ngcontent-%COMP%]{position:absolute;right:10px;bottom:10px;background:#111827;color:#fff;padding:6px 10px;border-radius:999px;font-weight:600;font-size:13px}.specs[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:6px;color:#444}.pagination[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:10px;margin-top:16px}.page-btn[_ngcontent-%COMP%]{padding:8px 12px;border:1px solid #ddd;background:#fff;border-radius:6px}.page-btn[disabled][_ngcontent-%COMP%]{opacity:.5}.active-filters[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center;flex-wrap:wrap;margin:8px 0 16px}.filter-chip[_ngcontent-%COMP%]{background:#eef2ff;color:#1f2937;padding:4px 8px;border-radius:999px;font-size:11px;border:1px solid #c7d2fe;display:inline-flex;align-items:center;gap:6px;transition:background .15s,box-shadow .15s,border-color .15s}.filter-chip[_ngcontent-%COMP%]:hover{background:#e3e8ff;border-color:#a5b4fc}.filter-chip[_ngcontent-%COMP%]:focus-within{outline:none;box-shadow:0 0 0 2px #2563eb40;border-color:#2563eb}.chip-close[_ngcontent-%COMP%]{border:none;background:transparent;color:#374151;cursor:pointer;padding:0;display:inline-flex;align-items:center;border-radius:50%}.chip-close[_ngcontent-%COMP%]:hover{color:#111827}.chip-close[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 2px #2563eb59}.chip-close[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;height:16px;width:16px;line-height:16px}.clear-filters[_ngcontent-%COMP%]{background:transparent;border:none;color:#2563eb;cursor:pointer}.find-car-container[_ngcontent-%COMP%]{max-width:1400px;margin:0 auto;padding:20px;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif}.mobile-header-buttons[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;padding:0 8px}.mobile-filter-btn[_ngcontent-%COMP%], .mobile-sort-btn[_ngcontent-%COMP%]{flex:1 1 50%;padding:12px 0;font-size:16px;font-weight:600;border:none;background:#f8f9fa;color:#007bff;border-radius:8px;margin:0 4px;box-shadow:0 1px 3px #0000000a}.mobile-filter-btn[_ngcontent-%COMP%]{text-align:left}.mobile-sort-btn[_ngcontent-%COMP%]{text-align:right}.header-section[_ngcontent-%COMP%]{display:none}@media (min-width: 768px){.mobile-header-buttons[_ngcontent-%COMP%]{display:none}.header-section[_ngcontent-%COMP%]{display:flex}}.header-section[_ngcontent-%COMP%]{justify-content:space-between;align-items:center;margin-bottom:30px;padding:20px;background-color:#f8f9fa;border-radius:8px;box-shadow:0 2px 4px #0000001a}.results-title[_ngcontent-%COMP%]{margin:0 0 8px;font-size:28px;font-weight:700;color:#2c3e50}.results-count[_ngcontent-%COMP%]{margin:0;color:#6c757d;font-size:14px}.sort-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.sort-label[_ngcontent-%COMP%]{font-weight:600;color:#495057}.sort-select[_ngcontent-%COMP%]{padding:8px 12px;border:2px solid #dee2e6;border-radius:6px;font-size:14px;background-color:#fff;cursor:pointer;transition:all .3s ease}.sort-select[_ngcontent-%COMP%]:hover{border-color:#007bff}.sort-select[_ngcontent-%COMP%]:focus{outline:none;border-color:#007bff;box-shadow:0 0 0 3px #007bff1a}.main-content[_ngcontent-%COMP%]{display:grid;grid-template-columns:300px 1fr;gap:30px}.filter-sidebar[_ngcontent-%COMP%]{background-color:#fff;border-radius:8px;box-shadow:0 2px 8px #0000001a;height:fit-content;position:sticky;top:20px}@media (max-width: 767px){.filter-sidebar[_ngcontent-%COMP%]{display:none!important}}.car-results[_ngcontent-%COMP%]{min-height:600px}.car-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(350px,1fr));gap:24px;margin-bottom:40px}.no-results[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;min-height:400px;text-align:center}.no-results-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:24px;color:#6c757d;margin-bottom:16px}.no-results-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#adb5bd;font-size:16px}.car-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;cursor:pointer}.thumb-wrap[_ngcontent-%COMP%]{position:relative;width:100%;aspect-ratio:16/9}.thumb[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.thumb.placeholder[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;background:#f2f2f2;color:#777;width:100%;height:100%}.price-badge[_ngcontent-%COMP%]{position:absolute;right:8px;top:8px;background:#000000b3;color:#fff;padding:4px 8px;border-radius:12px;font-weight:600}.specs[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:8px;margin-top:8px}.full[_ngcontent-%COMP%]{width:100%}.muted[_ngcontent-%COMP%]{color:#0009}.filter-sidebar[_ngcontent-%COMP%]   .filters-panel-inner[_ngcontent-%COMP%]{background:#fff;border-radius:8px;overflow:hidden}.filter-header[_ngcontent-%COMP%]{padding:12px 16px;border-bottom:1px solid #e9ecef;background:#fff;color:#111827;display:flex;align-items:center;justify-content:space-between}.filter-title[_ngcontent-%COMP%]{margin:0;font-size:16px;font-weight:700}.clear-all[_ngcontent-%COMP%]{color:#2563eb;text-decoration:none;font-weight:600;font-size:12px}.filter-content[_ngcontent-%COMP%]{max-height:calc(100vh - 200px);overflow-y:auto}.filter-section[_ngcontent-%COMP%]{border-bottom:1px solid #e9ecef}.filter-section[_ngcontent-%COMP%]:last-child{border-bottom:none}.section-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:12px 14px;cursor:pointer;background:#fff;transition:all .3s ease;border-bottom:1px solid #e9ecef}.section-title[_ngcontent-%COMP%]{margin:0;font-size:16px;font-weight:600;color:#2c3e50}.section-title-container[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:10px}.facet-icon[_ngcontent-%COMP%]{color:#1e3a8a;opacity:.9}.section-content[_ngcontent-%COMP%]{max-height:0;overflow:hidden;transition:max-height .3s ease}.section-content.expanded[_ngcontent-%COMP%]{max-height:400px;overflow-y:auto}.options-container[_ngcontent-%COMP%]{padding:8px}.filter-option[_ngcontent-%COMP%]{margin-bottom:12px}.option-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;cursor:pointer;font-size:14px;line-height:1.4;transition:all .3s ease;padding:4px 0}.custom-checkbox[_ngcontent-%COMP%]{position:relative;width:18px;height:18px;border:2px solid #dee2e6;border-radius:3px;background:#fff;display:flex;align-items:center;justify-content:center;transition:all .3s ease;flex-shrink:0}.option-text[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;justify-content:space-between;gap:8px}.topbar[_ngcontent-%COMP%]{display:flex;gap:16px;align-items:center;justify-content:flex-end;padding:8px 0 20px}.sort-wrap[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.results-header[_ngcontent-%COMP%]{font-weight:700;margin:6px 0 18px}.car-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:16px}@media (max-width: 1024px){.car-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}}@media (max-width: 640px){.car-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.car-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;border:1px solid #e5e7eb;border-radius:8px;overflow:hidden;background:#fff;box-shadow:0 1px 2px #0000000a}.card-media[_ngcontent-%COMP%]{position:relative;aspect-ratio:16/9;display:block;cursor:pointer}.card-media[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;display:block}.media-placeholder[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;background:#f3f4f6;color:#9ca3af;width:100%;height:100%}.price-tag[_ngcontent-%COMP%]{position:absolute;right:8px;top:8px;background:#000000bf;color:#fff;padding:4px 10px;border-radius:999px;font-weight:700;font-size:13px}.card-nav[_ngcontent-%COMP%]{position:absolute;top:50%;transform:translateY(-50%);background:#ffffffe6;border:1px solid #e5e7eb;width:28px;height:28px;border-radius:50%;display:grid;place-items:center;font-size:18px;cursor:pointer;color:#111827}.card-nav--left[_ngcontent-%COMP%]{left:8px}.card-nav--right[_ngcontent-%COMP%]{right:8px}.card-body[_ngcontent-%COMP%]{padding:12px 14px 14px;display:flex;flex-direction:column;gap:8px;min-height:136px}.title[_ngcontent-%COMP%]{font-weight:700;font-size:16px;color:#111827}.subtitle[_ngcontent-%COMP%]{color:#6b7280;font-size:13px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.chips[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:6px}.chips--inline[_ngcontent-%COMP%]{flex-wrap:nowrap;gap:12px;margin-bottom:0;margin-top:8px}.chip[_ngcontent-%COMP%]{background:#f3f4f6;color:#374151;border:1px solid #e5e7eb;border-radius:999px;padding:2px 8px;font-size:12px}.fuel-pill[_ngcontent-%COMP%]{align-self:flex-start;background:#f0f9ff;color:#0369a1;border:1px solid #bae6fd;border-radius:6px;padding:2px 8px;font-size:12px}.price-row[_ngcontent-%COMP%]{display:flex;align-items:baseline;justify-content:space-between;margin-top:6px}.price[_ngcontent-%COMP%]{font-size:18px;font-weight:800;color:#111827}.monthly[_ngcontent-%COMP%]{font-size:12px;color:#6b7280}.actions[_ngcontent-%COMP%]{display:flex;gap:8px;margin-top:8px}.btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;padding:8px 12px;border-radius:6px;font-weight:600;font-size:14px;text-decoration:none}.btn-primary[_ngcontent-%COMP%]{background:#dc2626;color:#fff}.btn-secondary[_ngcontent-%COMP%]{background:#f3f4f6;color:#111827;border:1px solid #e5e7eb}.chevron[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{transition:opacity .2s ease}.range-row[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:10px;padding:8px 12px}.range-input[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px;width:100%}.range-mini-label[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:#374151}.range-select[_ngcontent-%COMP%]{width:100%;padding:8px 10px;border:1px solid #e5e7eb;border-radius:6px;font-size:14px;background:#fff}.range-sep[_ngcontent-%COMP%]{color:#6b7280}.topbar[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:center;justify-content:flex-end;padding:8px 0 12px;flex-wrap:wrap}.filters-toggle[_ngcontent-%COMP%]{display:none;align-items:center;gap:6px;border:1px solid #e5e7eb;background:#fff;color:#374151;padding:6px 10px;border-radius:6px;font-size:13px}.filters-toggle[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;height:18px;width:18px}.right-controls[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:12px;margin-left:auto}.view-wrap[_ngcontent-%COMP%]{display:inline-flex;align-items:center}.view-btn[_ngcontent-%COMP%]{border:1px solid #e5e7eb;background:#fff;color:#374151;padding:6px;border-radius:6px;display:inline-flex;align-items:center;justify-content:center}.view-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;height:18px;width:18px}.view-btn.active[_ngcontent-%COMP%]{background:#eef2ff;border-color:#a5b4fc;color:#1f2937}.view-btn--single[_ngcontent-%COMP%]{width:36px;height:32px}.desktop-only[_ngcontent-%COMP%]{display:inline-flex}.mobile-sort-btn[_ngcontent-%COMP%]{display:none;align-items:center;gap:6px;border:1px solid #e5e7eb;background:#fff;color:#374151;padding:6px 10px;border-radius:6px;font-size:13px}.sort-panel[_ngcontent-%COMP%]{position:absolute;left:0;margin-top:8px;background:#fff;border:1px solid #e5e7eb;border-radius:8px;box-shadow:0 8px 20px #00000014;padding:6px;z-index:10;display:flex;flex-direction:column;min-width:200px}.sort-wrap[_ngcontent-%COMP%]{position:relative}.sort-item[_ngcontent-%COMP%]{text-align:left;background:transparent;border:none;padding:8px 10px;border-radius:6px;font-size:14px;color:#374151}.sort-item[_ngcontent-%COMP%]:hover{background:#f3f4f6}.sort-item.active[_ngcontent-%COMP%]{background:#eef2ff;color:#111827}@media (max-width: 767px){.topbar[_ngcontent-%COMP%]{justify-content:space-between}.filters-toggle[_ngcontent-%COMP%]{display:inline-flex}.view-wrap[_ngcontent-%COMP%]{display:none}.desktop-only[_ngcontent-%COMP%]{display:none!important}.mobile-sort-btn[_ngcontent-%COMP%]{display:inline-flex;margin-left:auto}}.filter-sidebar.show-mobile[_ngcontent-%COMP%]{display:block!important}.mobile-filter-footer[_ngcontent-%COMP%]{display:none}.active-filters[_ngcontent-%COMP%]{border-left:3px solid #e5e7eb;padding-left:8px}.active-filters--filters[_ngcontent-%COMP%]{display:none}.active-filters--results[_ngcontent-%COMP%]{display:flex}@media (max-width: 767px){.filter-sidebar.show-mobile[_ngcontent-%COMP%]{position:fixed;inset:0;z-index:1100;background:#fff;overflow:hidden;border-radius:0;box-shadow:none}.filter-sidebar.show-mobile[_ngcontent-%COMP%]   .filters-panel-inner[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column}.filter-sidebar.show-mobile[_ngcontent-%COMP%]   .filter-content[_ngcontent-%COMP%]{flex:1 1 auto;max-height:none;overflow-y:auto;padding-bottom:72px}.mobile-filter-footer[_ngcontent-%COMP%]{display:block;position:sticky;bottom:0;left:0;right:0;background:#fff;border-top:1px solid #e5e7eb;padding:10px;box-shadow:0 -6px 16px #0000000f;z-index:1200}.see-results-btn[_ngcontent-%COMP%]{width:100%;padding:12px 16px;font-weight:700;font-size:16px;color:#fff;background:#dc2626;border:none;border-radius:8px}.see-results-btn[_ngcontent-%COMP%]:hover{background:#b91c1c}.main-content.mobile-filters-open[_ngcontent-%COMP%]   .car-results[_ngcontent-%COMP%]{display:none}.find-car-container[_ngcontent-%COMP%]{padding:0;margin:0;max-width:none;width:100%}.main-content[_ngcontent-%COMP%]{gap:0}.car-results[_ngcontent-%COMP%]{padding:0;margin:0;width:100%}.car-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:0;width:100%}.car-card[_ngcontent-%COMP%]{border-radius:0}.card-media[_ngcontent-%COMP%]{aspect-ratio:4/3}.card-body[_ngcontent-%COMP%]{padding:8px}.active-filters--filters[_ngcontent-%COMP%]{display:flex}.active-filters--results[_ngcontent-%COMP%]{display:none}}.option-label[_ngcontent-%COMP%]{font-size:13px;gap:8px;padding:2px 0;align-items:center}.custom-checkbox[_ngcontent-%COMP%]{width:16px;height:16px}.filter-checkbox[_ngcontent-%COMP%]{display:none}.filter-checkbox[_ngcontent-%COMP%]:checked + .custom-checkbox[_ngcontent-%COMP%]{background:#007bff;border-color:#007bff}.filter-checkbox[_ngcontent-%COMP%]:checked + .custom-checkbox[_ngcontent-%COMP%]   .check-icon[_ngcontent-%COMP%]{opacity:1;transform:scale(1)}.check-icon[_ngcontent-%COMP%]{color:#fff;opacity:0;transform:scale(0);transition:all .3s ease}.car-grid.list-view[_ngcontent-%COMP%]{grid-template-columns:1fr}.car-card.list[_ngcontent-%COMP%]{flex-direction:row}.car-card.list[_ngcontent-%COMP%]   .card-media[_ngcontent-%COMP%]{width:40%}.car-card.list[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{width:60%}.find-car-container[_ngcontent-%COMP%]{padding:8px}.main-content[_ngcontent-%COMP%]{gap:12px}.results-header[_ngcontent-%COMP%]{margin:4px 0 10px}@media (max-width: 767px){.main-content[_ngcontent-%COMP%]{display:block;grid-template-columns:none;gap:0}.car-grid[_ngcontent-%COMP%]{gap:0}}\"],\n      changeDetection: 0\n    });\n  }\n  return SearchComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}