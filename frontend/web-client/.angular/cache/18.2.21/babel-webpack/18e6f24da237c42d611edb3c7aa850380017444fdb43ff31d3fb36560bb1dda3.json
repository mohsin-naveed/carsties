{"ast":null,"code":"import { inject } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { MatTabsModule } from '@angular/material/tabs';\nimport { MatCardModule } from '@angular/material/card';\nimport { MatIconModule } from '@angular/material/icon';\nimport { Router } from '@angular/router';\nimport { ListingsApiService } from '../listings/listings-api.service';\nimport { map, shareReplay } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nimport * as i2 from \"@angular/material/tabs\";\nimport * as i3 from \"@angular/material/card\";\nfunction BrowseTabsComponent_mat_card_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"mat-card\", 8);\n    i0.ɵɵlistener(\"click\", function BrowseTabsComponent_mat_card_3_Template_mat_card_click_0_listener() {\n      const m_r2 = i0.ɵɵrestoreView(_r1).$implicit;\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.goToMake(m_r2.code));\n    })(\"keyup.enter\", function BrowseTabsComponent_mat_card_3_Template_mat_card_keyup_enter_0_listener() {\n      const m_r2 = i0.ɵɵrestoreView(_r1).$implicit;\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.goToMake(m_r2.code));\n    });\n    i0.ɵɵelementStart(1, \"div\", 9);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 10);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const m_r2 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(m_r2.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"\", m_r2.count, \" listings\");\n  }\n}\nfunction BrowseTabsComponent_mat_card_7_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"mat-card\", 11);\n    i0.ɵɵlistener(\"click\", function BrowseTabsComponent_mat_card_7_Template_mat_card_click_0_listener() {\n      const m_r5 = i0.ɵɵrestoreView(_r4).$implicit;\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.goToModel(m_r5.code));\n    })(\"keyup.enter\", function BrowseTabsComponent_mat_card_7_Template_mat_card_keyup_enter_0_listener() {\n      const m_r5 = i0.ɵɵrestoreView(_r4).$implicit;\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.goToModel(m_r5.code));\n    });\n    i0.ɵɵelementStart(1, \"div\", 9);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 10);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const m_r5 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(m_r5.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"\", m_r5.count, \" listings\");\n  }\n}\nfunction BrowseTabsComponent_mat_card_11_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"mat-card\", 12);\n    i0.ɵɵlistener(\"click\", function BrowseTabsComponent_mat_card_11_Template_mat_card_click_0_listener() {\n      const b_r7 = i0.ɵɵrestoreView(_r6).$implicit;\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.goToBody(b_r7.code));\n    })(\"keyup.enter\", function BrowseTabsComponent_mat_card_11_Template_mat_card_keyup_enter_0_listener() {\n      const b_r7 = i0.ɵɵrestoreView(_r6).$implicit;\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.goToBody(b_r7.code));\n    });\n    i0.ɵɵelementStart(1, \"div\", 9);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 10);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const b_r7 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(b_r7.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"\", b_r7.count, \" listings\");\n  }\n}\nexport let BrowseTabsComponent = /*#__PURE__*/(() => {\n  class BrowseTabsComponent {\n    api = inject(ListingsApiService);\n    router = inject(Router);\n    // Base facet stream with no filters (initial) - can be extended later\n    facetCounts$ = this.api.getFacetCounts({}).pipe(map(dto => ({\n      makes: new Map(Object.entries(dto.makes)),\n      models: new Map(Object.entries(dto.models)),\n      bodies: new Map(Object.entries(dto.bodies)),\n      makeLabels: new Map(Object.entries(dto.makeLabels ?? {})),\n      modelLabels: new Map(Object.entries(dto.modelLabels ?? {})),\n      bodyLabels: new Map(Object.entries(dto.bodyLabels ?? {}))\n    })), shareReplay(1));\n    makes$ = this.facetCounts$.pipe(map(fc => Array.from(fc.makeLabels.entries()).map(([code, name]) => ({\n      code,\n      name,\n      count: fc.makes.get(code) ?? 0\n    })).filter(x => x.count > 0).sort((a, b) => b.count - a.count)), shareReplay(1));\n    models$ = this.facetCounts$.pipe(map(fc => Array.from(fc.modelLabels.entries()).map(([code, name]) => ({\n      code,\n      name,\n      count: fc.models.get(code) ?? 0\n    })).filter(x => x.count > 0).sort((a, b) => b.count - a.count)), shareReplay(1));\n    bodies$ = this.facetCounts$.pipe(map(fc => Array.from(fc.bodyLabels.entries()).map(([code, name]) => ({\n      code,\n      name,\n      count: fc.bodies.get(code) ?? 0\n    })).filter(x => x.count > 0).sort((a, b) => b.count - a.count)), shareReplay(1));\n    goToMake(code) {\n      this.router.navigate(['/search'], {\n        queryParams: {\n          makeCodes: [code]\n        }\n      });\n    }\n    goToModel(code) {\n      this.router.navigate(['/search'], {\n        queryParams: {\n          modelCodes: [code]\n        }\n      });\n    }\n    goToBody(code) {\n      this.router.navigate(['/search'], {\n        queryParams: {\n          bodyTypeCodes: [code]\n        }\n      });\n    }\n    static ɵfac = function BrowseTabsComponent_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || BrowseTabsComponent)();\n    };\n    static ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: BrowseTabsComponent,\n      selectors: [[\"app-browse-tabs\"]],\n      standalone: true,\n      features: [i0.ɵɵStandaloneFeature],\n      decls: 13,\n      vars: 9,\n      consts: [[\"aria-label\", \"Browse used cars\"], [\"label\", \"Make\"], [1, \"browse-grid\"], [\"class\", \"browse-card\", \"tabindex\", \"0\", \"aria-label\", \"Browse by make\", 3, \"click\", \"keyup.enter\", 4, \"ngFor\", \"ngForOf\"], [\"label\", \"Model\"], [\"class\", \"browse-card\", \"tabindex\", \"0\", \"aria-label\", \"Browse by model\", 3, \"click\", \"keyup.enter\", 4, \"ngFor\", \"ngForOf\"], [\"label\", \"Body Type\"], [\"class\", \"browse-card\", \"tabindex\", \"0\", \"aria-label\", \"Browse by body type\", 3, \"click\", \"keyup.enter\", 4, \"ngFor\", \"ngForOf\"], [\"tabindex\", \"0\", \"aria-label\", \"Browse by make\", 1, \"browse-card\", 3, \"click\", \"keyup.enter\"], [1, \"browse-card__title\"], [1, \"browse-card__count\"], [\"tabindex\", \"0\", \"aria-label\", \"Browse by model\", 1, \"browse-card\", 3, \"click\", \"keyup.enter\"], [\"tabindex\", \"0\", \"aria-label\", \"Browse by body type\", 1, \"browse-card\", 3, \"click\", \"keyup.enter\"]],\n      template: function BrowseTabsComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"mat-tab-group\", 0)(1, \"mat-tab\", 1)(2, \"div\", 2);\n          i0.ɵɵtemplate(3, BrowseTabsComponent_mat_card_3_Template, 5, 2, \"mat-card\", 3);\n          i0.ɵɵpipe(4, \"async\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(5, \"mat-tab\", 4)(6, \"div\", 2);\n          i0.ɵɵtemplate(7, BrowseTabsComponent_mat_card_7_Template, 5, 2, \"mat-card\", 5);\n          i0.ɵɵpipe(8, \"async\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(9, \"mat-tab\", 6)(10, \"div\", 2);\n          i0.ɵɵtemplate(11, BrowseTabsComponent_mat_card_11_Template, 5, 2, \"mat-card\", 7);\n          i0.ɵɵpipe(12, \"async\");\n          i0.ɵɵelementEnd()()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(4, 3, ctx.makes$));\n          i0.ɵɵadvance(4);\n          i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(8, 5, ctx.models$));\n          i0.ɵɵadvance(4);\n          i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(12, 7, ctx.bodies$));\n        }\n      },\n      dependencies: [CommonModule, i1.NgForOf, i1.AsyncPipe, MatTabsModule, i2.MatTab, i2.MatTabGroup, MatCardModule, i3.MatCard, MatIconModule],\n      styles: [\".browse-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(4,1fr);gap:12px;padding:12px}.browse-card[_ngcontent-%COMP%]{cursor:pointer;padding:12px;display:flex;flex-direction:column;gap:6px}.browse-card__title[_ngcontent-%COMP%]{font-weight:600}.browse-card__count[_ngcontent-%COMP%]{color:#64748b}@media (max-width: 1199px){.browse-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(3,1fr)}}@media (max-width: 959px){.browse-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}}@media (max-width: 599px){.browse-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}\"],\n      changeDetection: 0\n    });\n  }\n  return BrowseTabsComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}